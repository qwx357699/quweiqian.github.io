# yarn3.0 Ts é¡¹ç›®

æ‚¨æ˜¯å¦æœ‰å…´è¶£å°†æ‚¨çš„ç¬¬ä¸€ä¸ª typescript é¡¹ç›®ä¸ yarn ä¸€èµ·ä½œä¸ºåŒ…ç®¡ç†å™¨?
ç„¶åï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªå¿«é€Ÿçš„é£Ÿè°±ï¼Œè®©ä½ èµ°ä¸Šä½ çš„è·¯ã€‚

> æ­¤ç¤ºä¾‹çš„æ‰€æœ‰æºä»£ç éƒ½å¯ä»¥åœ¨[github](https://github.com/rabiddroid/example-typescript-template)ä¸­ã€‚

## å®‰è£… yarn

å®‰è£… yarn çš„é¦–é€‰æ–¹å¼æ˜¯é€šè¿‡ copackack(ä¸€ä¸ªå¸®åŠ©ç®¡ç†åŒ…ç®¡ç†å™¨ç‰ˆæœ¬çš„å®éªŒæ€§å·¥å…·)ã€‚è¿™æ˜¯ node.js è‡ªå¸¦çš„ï¼Œå–å†³äºä½ çš„ç‰ˆæœ¬ã€‚åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œæˆ‘ä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯ v18.6.0ã€‚å¯¹äºç‰ˆæœ¬< 16.10 çš„èŠ‚ç‚¹ï¼Œè¯·å‚è§ [Yarn Install](https://yarnpkg.com/getting-started/install)ã€‚

> æˆ‘å¼ºçƒˆå»ºè®®ä½¿ç”¨èŠ‚ç‚¹ç‰ˆæœ¬> 16.0.0 ä¸ºäº† yarn 3 å¦‚é¢„æœŸå·¥ä½œã€‚

åˆ›å»ºé¡¹ç›®æ–‡ä»¶å¤¹(â€¦å¹¶åœ¨ä¸€è¡Œä¸­è¾“å…¥ ğŸ¤“)

```bash
mkdir project-template-typescript && cd $_
```

è¿è¡Œå®‰è£…å’Œåˆå§‹åŒ– yarnã€‚

```bash
yarn init -2
```

> **æ³¨æ„:**é»˜è®¤æƒ…å†µä¸‹ï¼Œ`yarn init -2` ä¼šè®¾ç½®ä½ çš„é¡¹ç›®ä¸ [zero - install](https://yarnpkg.com/features/caching#zero-installs) å…¼å®¹ï¼Œè¿™éœ€è¦æ£€æŸ¥å­˜å‚¨åº“ä¸­çš„ç¼“å­˜;å¦‚æœæ‚¨æƒ³ç¦ç”¨æ­¤åŠŸèƒ½ï¼Œè¯·æ£€æŸ¥è®¾ç½®æ‚¨çš„*.gitignore*æ–‡ä»¶ã€‚

è¦æŸ¥çœ‹åŸºæœ¬çš„ yarn é¡¹ç›®çŠ¶æ€ï¼Œè¿è¡Œ

```bash
yarn install
```

> ä¹Ÿå¯ä»¥ç®€å•åœ°è¿è¡Œâ€œyarnâ€ã€‚

æ–‡ä»¶å¤¹å†…å®¹å¦‚ä¸‹æ‰€ç¤º

```js
.
â”œ .editorconfig
â”œ .git
â”œ .gitignore
â”œ .pnp.cjs
â”œ .yarn
â”œ .yarnrc.yml
â”œ README.md
â”œ package.json
â”” yarn.lock
```

çœ‹åˆ°æ–‡ä»¶/æ–‡ä»¶å¤¹çš„ä¸€äº›ç»†èŠ‚

- .editorconfig
  [https://editorconfig.org/](https://editorconfig.org/)
- .pnp.cjs
  åœ¨è¿™ç§å®‰è£…æ¨¡å¼ä¸‹(é»˜è®¤ä» Yarn 2.0 å¼€å§‹)ï¼ŒYarn ç”Ÿæˆä¸€ä¸ª `.pnp.cjs` æ–‡ä»¶ï¼Œè€Œä¸æ˜¯é€šå¸¸çš„åŒ…å«å„ç§åŒ…å‰¯æœ¬çš„`node_modules`æ–‡ä»¶å¤¹ã€‚`.pnp.cjs` æ–‡ä»¶åŒ…å«å„ç§æ˜ å°„ï¼šä¸€ä¸ªæ˜ å°„å°†åŒ…åç§°å’Œç‰ˆæœ¬é“¾æ¥åˆ°å®ƒä»¬åœ¨ç£ç›˜ä¸Šçš„ä½ç½®ï¼Œå¦ä¸€ä¸ªæ˜ å°„åˆ™å°†åŒ…åç§°ä¸ç‰ˆæœ¬é“¾æ¥åˆ°ä¾èµ–é¡¹åˆ—è¡¨ã€‚æœ‰äº†è¿™äº›æŸ¥æ‰¾è¡¨ï¼ŒYarn å¯ä»¥ç«‹å³å‘Šè¯‰ Node åœ¨å“ªé‡Œå¯ä»¥æ‰¾åˆ°å®ƒéœ€è¦è®¿é—®çš„ä»»ä½•åŒ…ï¼Œåªè¦å®ƒä»¬æ˜¯ä¾èµ–æ ‘çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸”åªè¦è¿™ä¸ªæ–‡ä»¶æ˜¯åœ¨æ‚¨çš„ç¯å¢ƒä¸­åŠ è½½çš„(ä¸‹ä¸€èŠ‚å°†è¯¦ç»†ä»‹ç»)[...ç»†èŠ‚](https://yarnpkg.com/features/pnp#fixing-node_modules)
- .yarn
  yarn äº§ç”Ÿçš„æ–‡ä»¶å¤¹
- .yarnrc.yml
  é…ç½® Yarn çš„å†…éƒ¨è®¾ç½®ã€‚
- package.json
  æè¿°åŒ…ç®¡ç†å™¨çš„é¡¹ç›®è¯¦ç»†ä¿¡æ¯å’Œè®¾ç½®ã€‚
- yarn.lock
  å®‰è£…è¿‡ç¨‹ä¸­çš„é‡è¦ä¿¡æ¯å­˜å‚¨åœ¨ `yarn.lock` é”æ–‡ä»¶ä¸­ï¼Œä»¥ä¾¿å®ƒå¯ä»¥åœ¨å®‰è£…ä¾èµ–é¡¹çš„æ¯ä¸ªç³»ç»Ÿä¹‹é—´å…±äº«ã€‚

## å®‰è£… typescript

æ·»åŠ  typescript

```bash
yarn add --dev typescript
```

ä½ å¯ä»¥é€‰æ‹©å¯ç”¨ Yarn çš„ [TypeScript æ’ä»¶](https://github.com/yarnpkg/berry/tree/master/packages/plugin-typescript)ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä½ è‡ªåŠ¨ç®¡ç†`@types/*`ä¾èµ–é¡¹ã€‚å¦‚æœé¡¹ç›®æ”¯æŒå®ƒï¼Œåˆ™åœ¨æ·»åŠ ä¾èµ–é¡¹æ—¶è‡ªåŠ¨å®‰è£…ç±»å‹å®šä¹‰ã€‚

```bash
yarn plugin import typescript
```

å¯é€‰åœ°ä¸º typescript æ·»åŠ  VSCode é›†æˆã€‚æŒ‰ç…§é¢å¤–çš„æ­¥éª¤è®© VSCode åœ¨å·¥ä½œç©ºé—´ä¸­ä½¿ç”¨æ–°çš„ typescript ç‰ˆæœ¬ã€‚[https://yarnpkg.com/getting-started/editor-sdks](https://yarnpkg.com/getting-started/editor-sdks)

```bash
yarn dlx @yarnpkg/sdks vscode
```

åˆå§‹åŒ– _tsconfig.json_ åŸºæœ¬è®¾ç½®

```bash
yarn tsc --init
```

## è¿è¡Œä»£ç 

è®©æˆ‘ä»¬è¿è¡Œç¬¬ä¸€ä¸ªä»£ç ã€‚
åœ¨ `<project_root>/src` ç›®å½•ä¸‹åˆ›å»º index.ts æ–‡ä»¶
æ·»åŠ å¦‚ä¸‹ä»£ç 

```js
function hello() {
  console.info("hello world!");
}

hello();
```

ä¸ºäº†ä¿æŒç®€å•æ˜äº†ï¼Œè€Œä¸å¿…å°†å…¶ç¼–è¯‘ä¸º javascriptï¼Œè®©æˆ‘ä»¬ä½¿ç”¨ **ts-node** è¿è¡Œå®ƒã€‚
å°† ts-node å’Œä¾èµ–é¡¹ `@types/node` æ·»åŠ åˆ°é¡¹ç›®ä¸­:

```bash
yarn add ts-node @types/node --dev
```

åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š

```bash
yarn ts-node src/index.ts
```

æ‚¨åº”è¯¥åœ¨æ§åˆ¶å°ä¸Šçœ‹åˆ°ä»¥ä¸‹å†…å®¹ã€‚

```bash
$ yarn ts-node src/index.ts
hello world!
```

ç¥è´ºä½ å»ºç«‹äº†ä½ çš„ç¬¬ä¸€ä¸ª typescript é¡¹ç›®ã€‚ç¥ä½ ç¼–ç¨‹ä¹‹æ—…æ„‰å¿«!

## æ–‡ç« æ¥æº

- [https://www.jeffreythomas.dev/typescript/yarn/yarn3/nodejs/2022/08/01/typescript-project-yarn-3.html](https://www.jeffreythomas.dev/typescript/yarn/yarn3/nodejs/2022/08/01/typescript-project-yarn-3.html)
