# gzip

gzip是一种压缩文件的算法

## B/S结构中的压缩传输

![](https://qwq9527.gitee.io/resource/imgs/2020-02-28-15-37-26.png)

优点：传输效率可能得到大幅提升

缺点：服务器的压缩需要时间，客户端的解压需要时间

## 使用webpack进行预压缩

使用`compression-webpack-plugin`插件对打包结果进行预压缩，可以移除服务器的压缩时间

![](https://qwq9527.gitee.io/resource/imgs/2020-02-28-15-41-44.png)

## 例子补充

gzip 压缩对图片视频压缩效果不大，反而增加压缩时间，导致响应时间变长，图片视频，一般不采用gzip压缩。

压缩原理简单来说就是将重复的字节替换达到压缩目的。

```js
// 若依项目vue2项目
const CompressionPlugin = require('compression-webpack-plugin');
// vue.config.js 中webpack部分的配置
configureWebpack: {
    name: name,
    resolve: {
      alias: {
        '@': resolve('src')
      }
    },
    plugins: [
      // http://doc.ruoyi.vip/ruoyi-vue/other/faq.html#使用gzip解压缩静态文件
      new CompressionPlugin({
        cache: false,                   // 不启用文件缓存
        test: /\.(js|css|html)?$/i,     // 压缩文件格式
        filename: '[path].gz[query]',   // 压缩后的文件名
        algorithm: 'gzip',              // 使用gzip压缩
        minRatio: 0.8                   // 压缩率小于1才会压缩
      })
    ],
  },
```

```shell
http {
    include       mime.types;
    default_type  application/octet-stream;
    sendfile        on;
    keepalive_timeout  65;
    
    gzip on;
	gzip_comp_level 5;
	gzip_min_length 256;
	gzip_proxied any;
	gzip_vary on;
	gzip_types
    	application/atom+xml
    	application/javascript
    	application/json
    	application/ld+json
    	application/manifest+json
    	application/rss+xml
    	application/vnd.geo+json
    	application/vnd.ms-fontobject
    	application/x-font-ttf
    	application/x-web-app-manifest+json
    	application/xhtml+xml
    	application/xml
    	font/opentype
    	image/bmp
    	image/svg+xml
    	image/x-icon
    	image/jpeg
    	image/jpg
    	image/png
    	text/cache-manifest
    	text/css
    	text/plain
    	text/vcard
    	text/vnd.rim.location.xloc
    	text/vtt
    	text/x-component
    	text/x-cross-domain-policy;
    server {
        listen       8888;
        server_name  localhost;
		
		location /index {
          gzip_static on;
          alias D:/CODE/2023_qwq/wuhonglei/RuoYi-Vue/ruoyi-ui/dist;
          index index.html;
        }

		location /admin {
            gzip_static on;
            alias   D:/CODE/2023_qwq/wuhonglei/RuoYi-Vue/ruoyi-ui/dist;
            try_files $uri $uri/  /admin/index.html;
            index index.html index.htm;
        }
       

        # 代理服务器 ruoyi后台 本地
        location /sucai{
            proxy_pass http://localhost:8080/sucai;
        }
        #error_page  404              /404.html;

        # redirect server error pages to the static page /50x.html
        #
        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   html;
        }

       
    }
```



## 参考资料

- [GZIP文件压缩原理以及实现_gzip压缩算法_ld0524的博客-CSDN博客](https://blog.csdn.net/qq_57822158/article/details/126189072)

- [nginx配置gzip压缩，优化传输效率，加快页面访问速度_jieyucx的博客-CSDN博客](https://blog.csdn.net/jieyucx/article/details/133123386)

- [前端图片最优化压缩方案 - 掘金 (juejin.cn)](https://juejin.cn/post/6940430496128040967)
