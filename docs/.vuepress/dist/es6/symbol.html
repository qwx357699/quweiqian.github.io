<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Symbol | 无间劫</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css">
    <meta name="description" content="Just playing around">
    
    <link rel="preload" href="/quweiqian/assets/css/0.styles.ef198843.css" as="style"><link rel="preload" href="/quweiqian/assets/js/app.a7ba3ea9.js" as="script"><link rel="preload" href="/quweiqian/assets/js/4.1d87bada.js" as="script"><link rel="preload" href="/quweiqian/assets/js/168.9f8fbb5b.js" as="script"><link rel="prefetch" href="/quweiqian/assets/js/10.c245a6ba.js"><link rel="prefetch" href="/quweiqian/assets/js/100.317a7573.js"><link rel="prefetch" href="/quweiqian/assets/js/101.18c63611.js"><link rel="prefetch" href="/quweiqian/assets/js/102.2fe8d3e9.js"><link rel="prefetch" href="/quweiqian/assets/js/103.1e1eebae.js"><link rel="prefetch" href="/quweiqian/assets/js/104.590a0bc6.js"><link rel="prefetch" href="/quweiqian/assets/js/105.ddae05f7.js"><link rel="prefetch" href="/quweiqian/assets/js/106.05f620cc.js"><link rel="prefetch" href="/quweiqian/assets/js/107.26f2741e.js"><link rel="prefetch" href="/quweiqian/assets/js/108.e9bf4612.js"><link rel="prefetch" href="/quweiqian/assets/js/109.7f5a903f.js"><link rel="prefetch" href="/quweiqian/assets/js/11.4a9595a5.js"><link rel="prefetch" href="/quweiqian/assets/js/110.277c4c0b.js"><link rel="prefetch" href="/quweiqian/assets/js/111.0d273c27.js"><link rel="prefetch" href="/quweiqian/assets/js/112.1083ff25.js"><link rel="prefetch" href="/quweiqian/assets/js/113.0508a579.js"><link rel="prefetch" href="/quweiqian/assets/js/114.560bccdc.js"><link rel="prefetch" href="/quweiqian/assets/js/115.1e041667.js"><link rel="prefetch" href="/quweiqian/assets/js/116.f7a7aab6.js"><link rel="prefetch" href="/quweiqian/assets/js/117.036f156f.js"><link rel="prefetch" href="/quweiqian/assets/js/118.a336b8db.js"><link rel="prefetch" href="/quweiqian/assets/js/119.0fd0f9af.js"><link rel="prefetch" href="/quweiqian/assets/js/12.0256800c.js"><link rel="prefetch" href="/quweiqian/assets/js/120.a3c1e4ab.js"><link rel="prefetch" href="/quweiqian/assets/js/121.153c2309.js"><link rel="prefetch" href="/quweiqian/assets/js/122.50242b45.js"><link rel="prefetch" href="/quweiqian/assets/js/123.97a18804.js"><link rel="prefetch" href="/quweiqian/assets/js/124.9447d10a.js"><link rel="prefetch" href="/quweiqian/assets/js/125.5b71f65d.js"><link rel="prefetch" href="/quweiqian/assets/js/126.a74a9698.js"><link rel="prefetch" href="/quweiqian/assets/js/127.f4261d5c.js"><link rel="prefetch" href="/quweiqian/assets/js/128.34279a1c.js"><link rel="prefetch" href="/quweiqian/assets/js/129.91532625.js"><link rel="prefetch" href="/quweiqian/assets/js/13.8cdf57a2.js"><link rel="prefetch" href="/quweiqian/assets/js/130.eeb25bb0.js"><link rel="prefetch" href="/quweiqian/assets/js/131.aea06970.js"><link rel="prefetch" href="/quweiqian/assets/js/132.a3fc1e05.js"><link rel="prefetch" href="/quweiqian/assets/js/133.3d145b58.js"><link rel="prefetch" href="/quweiqian/assets/js/134.7d423bc5.js"><link rel="prefetch" href="/quweiqian/assets/js/135.79529fae.js"><link rel="prefetch" href="/quweiqian/assets/js/136.df91cd23.js"><link rel="prefetch" href="/quweiqian/assets/js/137.faaadf8c.js"><link rel="prefetch" href="/quweiqian/assets/js/138.92c967a6.js"><link rel="prefetch" href="/quweiqian/assets/js/139.38408ae1.js"><link rel="prefetch" href="/quweiqian/assets/js/14.045be458.js"><link rel="prefetch" href="/quweiqian/assets/js/140.74d9ca6c.js"><link rel="prefetch" href="/quweiqian/assets/js/141.59d838d9.js"><link rel="prefetch" href="/quweiqian/assets/js/142.89445c5e.js"><link rel="prefetch" href="/quweiqian/assets/js/143.05a66cb9.js"><link rel="prefetch" href="/quweiqian/assets/js/144.6ca8eca8.js"><link rel="prefetch" href="/quweiqian/assets/js/145.b6b905ff.js"><link rel="prefetch" href="/quweiqian/assets/js/146.c86d08b5.js"><link rel="prefetch" href="/quweiqian/assets/js/147.284d59f1.js"><link rel="prefetch" href="/quweiqian/assets/js/148.eb5dee13.js"><link rel="prefetch" href="/quweiqian/assets/js/149.b3550793.js"><link rel="prefetch" href="/quweiqian/assets/js/15.04d758e5.js"><link rel="prefetch" href="/quweiqian/assets/js/150.fd880712.js"><link rel="prefetch" href="/quweiqian/assets/js/151.c78cd6fa.js"><link rel="prefetch" href="/quweiqian/assets/js/152.98e8d80e.js"><link rel="prefetch" href="/quweiqian/assets/js/153.6d83d58c.js"><link rel="prefetch" href="/quweiqian/assets/js/154.1c709320.js"><link rel="prefetch" href="/quweiqian/assets/js/155.d8fea693.js"><link rel="prefetch" href="/quweiqian/assets/js/156.5b2d5f3a.js"><link rel="prefetch" href="/quweiqian/assets/js/157.81827573.js"><link rel="prefetch" href="/quweiqian/assets/js/158.877a710d.js"><link rel="prefetch" href="/quweiqian/assets/js/159.77b69cb6.js"><link rel="prefetch" href="/quweiqian/assets/js/16.6ab021c8.js"><link rel="prefetch" href="/quweiqian/assets/js/160.f0c33307.js"><link rel="prefetch" href="/quweiqian/assets/js/161.12f29201.js"><link rel="prefetch" href="/quweiqian/assets/js/162.23271bad.js"><link rel="prefetch" href="/quweiqian/assets/js/163.fde6cf3d.js"><link rel="prefetch" href="/quweiqian/assets/js/164.7b142ad8.js"><link rel="prefetch" href="/quweiqian/assets/js/165.04231145.js"><link rel="prefetch" href="/quweiqian/assets/js/166.18f2f083.js"><link rel="prefetch" href="/quweiqian/assets/js/167.030a9bc1.js"><link rel="prefetch" href="/quweiqian/assets/js/169.619a6c27.js"><link rel="prefetch" href="/quweiqian/assets/js/17.8fe57812.js"><link rel="prefetch" href="/quweiqian/assets/js/170.92e65224.js"><link rel="prefetch" href="/quweiqian/assets/js/171.d682214e.js"><link rel="prefetch" href="/quweiqian/assets/js/172.da459034.js"><link rel="prefetch" href="/quweiqian/assets/js/173.bf3d60bc.js"><link rel="prefetch" href="/quweiqian/assets/js/174.49561d0e.js"><link rel="prefetch" href="/quweiqian/assets/js/175.fe690312.js"><link rel="prefetch" href="/quweiqian/assets/js/176.7e6cd90a.js"><link rel="prefetch" href="/quweiqian/assets/js/177.0a59d724.js"><link rel="prefetch" href="/quweiqian/assets/js/178.5e8c168a.js"><link rel="prefetch" href="/quweiqian/assets/js/179.580fd5a4.js"><link rel="prefetch" href="/quweiqian/assets/js/18.f19f9a56.js"><link rel="prefetch" href="/quweiqian/assets/js/180.d9e4b471.js"><link rel="prefetch" href="/quweiqian/assets/js/181.f1708da6.js"><link rel="prefetch" href="/quweiqian/assets/js/182.a9e5c659.js"><link rel="prefetch" href="/quweiqian/assets/js/183.cf5bbf84.js"><link rel="prefetch" href="/quweiqian/assets/js/184.c813cc7a.js"><link rel="prefetch" href="/quweiqian/assets/js/185.c9c44857.js"><link rel="prefetch" href="/quweiqian/assets/js/186.39ee635f.js"><link rel="prefetch" href="/quweiqian/assets/js/187.666d1a8b.js"><link rel="prefetch" href="/quweiqian/assets/js/188.de8aa9e6.js"><link rel="prefetch" href="/quweiqian/assets/js/189.706df3e2.js"><link rel="prefetch" href="/quweiqian/assets/js/19.67d3eab6.js"><link rel="prefetch" href="/quweiqian/assets/js/190.d2a2376f.js"><link rel="prefetch" href="/quweiqian/assets/js/191.d6c57029.js"><link rel="prefetch" href="/quweiqian/assets/js/192.5328b9c9.js"><link rel="prefetch" href="/quweiqian/assets/js/193.c65c8554.js"><link rel="prefetch" href="/quweiqian/assets/js/194.c2a843b5.js"><link rel="prefetch" href="/quweiqian/assets/js/195.e6af94fc.js"><link rel="prefetch" href="/quweiqian/assets/js/196.e6b6d8ab.js"><link rel="prefetch" href="/quweiqian/assets/js/197.62cb25ca.js"><link rel="prefetch" href="/quweiqian/assets/js/198.8472b0b8.js"><link rel="prefetch" href="/quweiqian/assets/js/199.a00614f7.js"><link rel="prefetch" href="/quweiqian/assets/js/2.929d46df.js"><link rel="prefetch" href="/quweiqian/assets/js/20.d5ca6fba.js"><link rel="prefetch" href="/quweiqian/assets/js/200.4175c364.js"><link rel="prefetch" href="/quweiqian/assets/js/201.cf78d495.js"><link rel="prefetch" href="/quweiqian/assets/js/202.0c59fa01.js"><link rel="prefetch" href="/quweiqian/assets/js/203.e678f81a.js"><link rel="prefetch" href="/quweiqian/assets/js/204.12721505.js"><link rel="prefetch" href="/quweiqian/assets/js/205.393e7f4e.js"><link rel="prefetch" href="/quweiqian/assets/js/206.45c673b1.js"><link rel="prefetch" href="/quweiqian/assets/js/207.d382a98f.js"><link rel="prefetch" href="/quweiqian/assets/js/208.5f9f66aa.js"><link rel="prefetch" href="/quweiqian/assets/js/209.f05129a6.js"><link rel="prefetch" href="/quweiqian/assets/js/21.57bee6b2.js"><link rel="prefetch" href="/quweiqian/assets/js/210.c322c430.js"><link rel="prefetch" href="/quweiqian/assets/js/211.e506adc6.js"><link rel="prefetch" href="/quweiqian/assets/js/212.1a89c5c0.js"><link rel="prefetch" href="/quweiqian/assets/js/213.d17c89dc.js"><link rel="prefetch" href="/quweiqian/assets/js/214.ef30e526.js"><link rel="prefetch" href="/quweiqian/assets/js/215.614f4766.js"><link rel="prefetch" href="/quweiqian/assets/js/216.336d2ad8.js"><link rel="prefetch" href="/quweiqian/assets/js/217.26a4f376.js"><link rel="prefetch" href="/quweiqian/assets/js/218.78b8fc1c.js"><link rel="prefetch" href="/quweiqian/assets/js/219.54221b35.js"><link rel="prefetch" href="/quweiqian/assets/js/22.f3840e2e.js"><link rel="prefetch" href="/quweiqian/assets/js/220.58b29b71.js"><link rel="prefetch" href="/quweiqian/assets/js/221.babe9dda.js"><link rel="prefetch" href="/quweiqian/assets/js/222.458d32e5.js"><link rel="prefetch" href="/quweiqian/assets/js/223.08e8a97f.js"><link rel="prefetch" href="/quweiqian/assets/js/224.758feabe.js"><link rel="prefetch" href="/quweiqian/assets/js/225.32101980.js"><link rel="prefetch" href="/quweiqian/assets/js/226.17ce58e9.js"><link rel="prefetch" href="/quweiqian/assets/js/227.7ed2f8ce.js"><link rel="prefetch" href="/quweiqian/assets/js/228.b459e77f.js"><link rel="prefetch" href="/quweiqian/assets/js/229.dc6ea011.js"><link rel="prefetch" href="/quweiqian/assets/js/23.d6528f32.js"><link rel="prefetch" href="/quweiqian/assets/js/230.31b0a15a.js"><link rel="prefetch" href="/quweiqian/assets/js/231.f6510539.js"><link rel="prefetch" href="/quweiqian/assets/js/232.87c7446a.js"><link rel="prefetch" href="/quweiqian/assets/js/233.f8a36619.js"><link rel="prefetch" href="/quweiqian/assets/js/234.0f4c782f.js"><link rel="prefetch" href="/quweiqian/assets/js/235.9b8695cf.js"><link rel="prefetch" href="/quweiqian/assets/js/236.4689767c.js"><link rel="prefetch" href="/quweiqian/assets/js/237.126aab39.js"><link rel="prefetch" href="/quweiqian/assets/js/238.ea2ba718.js"><link rel="prefetch" href="/quweiqian/assets/js/239.70b71455.js"><link rel="prefetch" href="/quweiqian/assets/js/24.3cf98fd4.js"><link rel="prefetch" href="/quweiqian/assets/js/240.8b4e394d.js"><link rel="prefetch" href="/quweiqian/assets/js/241.24298bd7.js"><link rel="prefetch" href="/quweiqian/assets/js/242.b517757c.js"><link rel="prefetch" href="/quweiqian/assets/js/243.b0f23a07.js"><link rel="prefetch" href="/quweiqian/assets/js/244.ba4f4ebe.js"><link rel="prefetch" href="/quweiqian/assets/js/245.4b36b2b2.js"><link rel="prefetch" href="/quweiqian/assets/js/246.d64c7448.js"><link rel="prefetch" href="/quweiqian/assets/js/247.915c2a19.js"><link rel="prefetch" href="/quweiqian/assets/js/248.1d968b8b.js"><link rel="prefetch" href="/quweiqian/assets/js/249.861768cc.js"><link rel="prefetch" href="/quweiqian/assets/js/25.25c8adad.js"><link rel="prefetch" href="/quweiqian/assets/js/250.b27fb7d0.js"><link rel="prefetch" href="/quweiqian/assets/js/251.966e1480.js"><link rel="prefetch" href="/quweiqian/assets/js/252.92e7333d.js"><link rel="prefetch" href="/quweiqian/assets/js/253.08042c94.js"><link rel="prefetch" href="/quweiqian/assets/js/254.2131e34e.js"><link rel="prefetch" href="/quweiqian/assets/js/255.872fc45c.js"><link rel="prefetch" href="/quweiqian/assets/js/256.bc85dd89.js"><link rel="prefetch" href="/quweiqian/assets/js/257.8e9aa1e4.js"><link rel="prefetch" href="/quweiqian/assets/js/258.d7468ace.js"><link rel="prefetch" href="/quweiqian/assets/js/259.c5ac605b.js"><link rel="prefetch" href="/quweiqian/assets/js/26.4ba45770.js"><link rel="prefetch" href="/quweiqian/assets/js/260.6089f5af.js"><link rel="prefetch" href="/quweiqian/assets/js/261.16374a4e.js"><link rel="prefetch" href="/quweiqian/assets/js/262.0d00c64d.js"><link rel="prefetch" href="/quweiqian/assets/js/263.40d7b5f5.js"><link rel="prefetch" href="/quweiqian/assets/js/264.9ec9d767.js"><link rel="prefetch" href="/quweiqian/assets/js/265.40b2e3ee.js"><link rel="prefetch" href="/quweiqian/assets/js/266.f0567b25.js"><link rel="prefetch" href="/quweiqian/assets/js/267.25014dce.js"><link rel="prefetch" href="/quweiqian/assets/js/268.8c7cb54a.js"><link rel="prefetch" href="/quweiqian/assets/js/269.e1765bff.js"><link rel="prefetch" href="/quweiqian/assets/js/27.d8d3ba80.js"><link rel="prefetch" href="/quweiqian/assets/js/270.b7f4733f.js"><link rel="prefetch" href="/quweiqian/assets/js/271.403c3bf1.js"><link rel="prefetch" href="/quweiqian/assets/js/272.ee254347.js"><link rel="prefetch" href="/quweiqian/assets/js/273.33c3829e.js"><link rel="prefetch" href="/quweiqian/assets/js/274.c2e82c4e.js"><link rel="prefetch" href="/quweiqian/assets/js/275.63f109ed.js"><link rel="prefetch" href="/quweiqian/assets/js/276.53b0fe85.js"><link rel="prefetch" href="/quweiqian/assets/js/277.b94b9194.js"><link rel="prefetch" href="/quweiqian/assets/js/278.35a84d11.js"><link rel="prefetch" href="/quweiqian/assets/js/279.ad51a270.js"><link rel="prefetch" href="/quweiqian/assets/js/28.f826d580.js"><link rel="prefetch" href="/quweiqian/assets/js/280.0616bc4b.js"><link rel="prefetch" href="/quweiqian/assets/js/281.6f2a0c80.js"><link rel="prefetch" href="/quweiqian/assets/js/282.1abd79c2.js"><link rel="prefetch" href="/quweiqian/assets/js/283.58ad99e0.js"><link rel="prefetch" href="/quweiqian/assets/js/284.dafbc178.js"><link rel="prefetch" href="/quweiqian/assets/js/285.9eb2384e.js"><link rel="prefetch" href="/quweiqian/assets/js/286.93f62603.js"><link rel="prefetch" href="/quweiqian/assets/js/287.5f23bac7.js"><link rel="prefetch" href="/quweiqian/assets/js/288.fc71be7a.js"><link rel="prefetch" href="/quweiqian/assets/js/289.79d91d5e.js"><link rel="prefetch" href="/quweiqian/assets/js/29.24bfda25.js"><link rel="prefetch" href="/quweiqian/assets/js/290.89bb467e.js"><link rel="prefetch" href="/quweiqian/assets/js/291.09c80536.js"><link rel="prefetch" href="/quweiqian/assets/js/292.d2ea7a81.js"><link rel="prefetch" href="/quweiqian/assets/js/293.4aaf70e4.js"><link rel="prefetch" href="/quweiqian/assets/js/294.e7f57229.js"><link rel="prefetch" href="/quweiqian/assets/js/295.e593ed66.js"><link rel="prefetch" href="/quweiqian/assets/js/296.7610d75c.js"><link rel="prefetch" href="/quweiqian/assets/js/297.f404dd37.js"><link rel="prefetch" href="/quweiqian/assets/js/298.4c7aa98a.js"><link rel="prefetch" href="/quweiqian/assets/js/299.e0e457d5.js"><link rel="prefetch" href="/quweiqian/assets/js/3.e07d29c5.js"><link rel="prefetch" href="/quweiqian/assets/js/30.4d65d84b.js"><link rel="prefetch" href="/quweiqian/assets/js/300.c0aa3b09.js"><link rel="prefetch" href="/quweiqian/assets/js/301.f3a48291.js"><link rel="prefetch" href="/quweiqian/assets/js/302.a0de83bb.js"><link rel="prefetch" href="/quweiqian/assets/js/303.ce9ddc79.js"><link rel="prefetch" href="/quweiqian/assets/js/304.0ac0206f.js"><link rel="prefetch" href="/quweiqian/assets/js/305.6cd5273e.js"><link rel="prefetch" href="/quweiqian/assets/js/306.90ae3d44.js"><link rel="prefetch" href="/quweiqian/assets/js/307.ce0875ae.js"><link rel="prefetch" href="/quweiqian/assets/js/308.a29c993e.js"><link rel="prefetch" href="/quweiqian/assets/js/309.95d6447a.js"><link rel="prefetch" href="/quweiqian/assets/js/31.43ca0dbc.js"><link rel="prefetch" href="/quweiqian/assets/js/310.546c2c30.js"><link rel="prefetch" href="/quweiqian/assets/js/311.d66d7228.js"><link rel="prefetch" href="/quweiqian/assets/js/312.d5ed4e11.js"><link rel="prefetch" href="/quweiqian/assets/js/313.8e880349.js"><link rel="prefetch" href="/quweiqian/assets/js/314.598963ab.js"><link rel="prefetch" href="/quweiqian/assets/js/315.0ee2a3ab.js"><link rel="prefetch" href="/quweiqian/assets/js/316.c171f0fb.js"><link rel="prefetch" href="/quweiqian/assets/js/317.ade9cc2a.js"><link rel="prefetch" href="/quweiqian/assets/js/318.cf9a5a3e.js"><link rel="prefetch" href="/quweiqian/assets/js/319.2cc0ff8f.js"><link rel="prefetch" href="/quweiqian/assets/js/32.c202f570.js"><link rel="prefetch" href="/quweiqian/assets/js/320.0bdee58d.js"><link rel="prefetch" href="/quweiqian/assets/js/321.74a269ac.js"><link rel="prefetch" href="/quweiqian/assets/js/322.e3712639.js"><link rel="prefetch" href="/quweiqian/assets/js/323.a94ee8ca.js"><link rel="prefetch" href="/quweiqian/assets/js/324.cee691e8.js"><link rel="prefetch" href="/quweiqian/assets/js/325.945ae5f4.js"><link rel="prefetch" href="/quweiqian/assets/js/326.1ce8a112.js"><link rel="prefetch" href="/quweiqian/assets/js/327.32f4d670.js"><link rel="prefetch" href="/quweiqian/assets/js/328.97d26219.js"><link rel="prefetch" href="/quweiqian/assets/js/329.d3bc5f4b.js"><link rel="prefetch" href="/quweiqian/assets/js/33.b5f0e665.js"><link rel="prefetch" href="/quweiqian/assets/js/330.3529aa5f.js"><link rel="prefetch" href="/quweiqian/assets/js/331.abe41e7b.js"><link rel="prefetch" href="/quweiqian/assets/js/332.58f0cdfc.js"><link rel="prefetch" href="/quweiqian/assets/js/333.a3905a75.js"><link rel="prefetch" href="/quweiqian/assets/js/334.ee44314e.js"><link rel="prefetch" href="/quweiqian/assets/js/335.8ae90753.js"><link rel="prefetch" href="/quweiqian/assets/js/336.767502de.js"><link rel="prefetch" href="/quweiqian/assets/js/337.028701b6.js"><link rel="prefetch" href="/quweiqian/assets/js/338.eb8e8111.js"><link rel="prefetch" href="/quweiqian/assets/js/339.7c211b2b.js"><link rel="prefetch" href="/quweiqian/assets/js/34.17a89eb7.js"><link rel="prefetch" href="/quweiqian/assets/js/340.8e8e0817.js"><link rel="prefetch" href="/quweiqian/assets/js/341.4b4e17f9.js"><link rel="prefetch" href="/quweiqian/assets/js/342.a1081b56.js"><link rel="prefetch" href="/quweiqian/assets/js/343.50125056.js"><link rel="prefetch" href="/quweiqian/assets/js/344.88eb9f94.js"><link rel="prefetch" href="/quweiqian/assets/js/345.05cbfd07.js"><link rel="prefetch" href="/quweiqian/assets/js/346.c6c362a4.js"><link rel="prefetch" href="/quweiqian/assets/js/347.f5c837d2.js"><link rel="prefetch" href="/quweiqian/assets/js/348.7f78b8dc.js"><link rel="prefetch" href="/quweiqian/assets/js/349.84e58aaf.js"><link rel="prefetch" href="/quweiqian/assets/js/35.93933773.js"><link rel="prefetch" href="/quweiqian/assets/js/350.c1c7c09c.js"><link rel="prefetch" href="/quweiqian/assets/js/36.56bbe68b.js"><link rel="prefetch" href="/quweiqian/assets/js/37.1f37bdda.js"><link rel="prefetch" href="/quweiqian/assets/js/38.4879f9f1.js"><link rel="prefetch" href="/quweiqian/assets/js/39.95a93e82.js"><link rel="prefetch" href="/quweiqian/assets/js/40.2391fd03.js"><link rel="prefetch" href="/quweiqian/assets/js/41.547f9741.js"><link rel="prefetch" href="/quweiqian/assets/js/42.75f7d61c.js"><link rel="prefetch" href="/quweiqian/assets/js/43.74447ae9.js"><link rel="prefetch" href="/quweiqian/assets/js/44.74e8cc35.js"><link rel="prefetch" href="/quweiqian/assets/js/45.e27b8780.js"><link rel="prefetch" href="/quweiqian/assets/js/46.3af9c1f8.js"><link rel="prefetch" href="/quweiqian/assets/js/47.5fd7975a.js"><link rel="prefetch" href="/quweiqian/assets/js/48.35761d53.js"><link rel="prefetch" href="/quweiqian/assets/js/49.e5ee4159.js"><link rel="prefetch" href="/quweiqian/assets/js/5.89aa6b86.js"><link rel="prefetch" href="/quweiqian/assets/js/50.bbbc536e.js"><link rel="prefetch" href="/quweiqian/assets/js/51.71100fc5.js"><link rel="prefetch" href="/quweiqian/assets/js/52.e236e64e.js"><link rel="prefetch" href="/quweiqian/assets/js/53.2a3d1288.js"><link rel="prefetch" href="/quweiqian/assets/js/54.701aca4c.js"><link rel="prefetch" href="/quweiqian/assets/js/55.a3ae1cb8.js"><link rel="prefetch" href="/quweiqian/assets/js/56.d1a9dbb0.js"><link rel="prefetch" href="/quweiqian/assets/js/57.09ab3a66.js"><link rel="prefetch" href="/quweiqian/assets/js/58.2c197e61.js"><link rel="prefetch" href="/quweiqian/assets/js/59.1775d3ca.js"><link rel="prefetch" href="/quweiqian/assets/js/6.f4568d81.js"><link rel="prefetch" href="/quweiqian/assets/js/60.aa0c634b.js"><link rel="prefetch" href="/quweiqian/assets/js/61.979b5aad.js"><link rel="prefetch" href="/quweiqian/assets/js/62.24d519d0.js"><link rel="prefetch" href="/quweiqian/assets/js/63.7ce9d02b.js"><link rel="prefetch" href="/quweiqian/assets/js/64.ec195d0a.js"><link rel="prefetch" href="/quweiqian/assets/js/65.38a78bb1.js"><link rel="prefetch" href="/quweiqian/assets/js/66.87a000a3.js"><link rel="prefetch" href="/quweiqian/assets/js/67.8953a144.js"><link rel="prefetch" href="/quweiqian/assets/js/68.9480f059.js"><link rel="prefetch" href="/quweiqian/assets/js/69.c484e045.js"><link rel="prefetch" href="/quweiqian/assets/js/7.dabfea97.js"><link rel="prefetch" href="/quweiqian/assets/js/70.337b00e3.js"><link rel="prefetch" href="/quweiqian/assets/js/71.a5fcc798.js"><link rel="prefetch" href="/quweiqian/assets/js/72.76729d30.js"><link rel="prefetch" href="/quweiqian/assets/js/73.0c2727e4.js"><link rel="prefetch" href="/quweiqian/assets/js/74.6ed36a70.js"><link rel="prefetch" href="/quweiqian/assets/js/75.08c257e1.js"><link rel="prefetch" href="/quweiqian/assets/js/76.10efbc49.js"><link rel="prefetch" href="/quweiqian/assets/js/77.a6e0147f.js"><link rel="prefetch" href="/quweiqian/assets/js/78.ffcce216.js"><link rel="prefetch" href="/quweiqian/assets/js/79.1071e814.js"><link rel="prefetch" href="/quweiqian/assets/js/8.5380a994.js"><link rel="prefetch" href="/quweiqian/assets/js/80.ca914fcf.js"><link rel="prefetch" href="/quweiqian/assets/js/81.c7f02e19.js"><link rel="prefetch" href="/quweiqian/assets/js/82.48a4f3c7.js"><link rel="prefetch" href="/quweiqian/assets/js/83.f2b026da.js"><link rel="prefetch" href="/quweiqian/assets/js/84.4e98314b.js"><link rel="prefetch" href="/quweiqian/assets/js/85.415a733e.js"><link rel="prefetch" href="/quweiqian/assets/js/86.4dc0bb19.js"><link rel="prefetch" href="/quweiqian/assets/js/87.b63f273d.js"><link rel="prefetch" href="/quweiqian/assets/js/88.fa1a065f.js"><link rel="prefetch" href="/quweiqian/assets/js/89.b8256acf.js"><link rel="prefetch" href="/quweiqian/assets/js/9.83981d33.js"><link rel="prefetch" href="/quweiqian/assets/js/90.bbaefadf.js"><link rel="prefetch" href="/quweiqian/assets/js/91.cd62c956.js"><link rel="prefetch" href="/quweiqian/assets/js/92.835714c7.js"><link rel="prefetch" href="/quweiqian/assets/js/93.131c6633.js"><link rel="prefetch" href="/quweiqian/assets/js/94.b521f547.js"><link rel="prefetch" href="/quweiqian/assets/js/95.c774fff8.js"><link rel="prefetch" href="/quweiqian/assets/js/96.4d6bd82f.js"><link rel="prefetch" href="/quweiqian/assets/js/97.c4accc8f.js"><link rel="prefetch" href="/quweiqian/assets/js/98.27318c92.js"><link rel="prefetch" href="/quweiqian/assets/js/99.b1f7af25.js">
    <link rel="stylesheet" href="/quweiqian/assets/css/0.styles.ef198843.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/quweiqian/" class="home-link router-link-active"><!----> <span class="site-name">无间劫</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/quweiqian/" class="nav-link">
  home
</a></div><div class="nav-item"><a href="/quweiqian/base/frontend-base-htmlcss-master/5/10.html" class="nav-link">
  基础
</a></div><div class="nav-item"><a href="/quweiqian/duyi/frontend-pre-htmlcss-master/01.html" class="nav-link">
  固定学习
</a></div><div class="nav-item"><a href="/quweiqian/interview/frontend-interview-html-master/1.html" class="nav-link">
  笔面试
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="context Menu" class="dropdown-title"><span class="title">详细版</span> <span class="arrow down"></span></button> <button type="button" aria-label="context Menu" class="mobile-dropdown-title"><span class="title">详细版</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/quweiqian/particular/frontend-es6-particular-master/1.html" class="nav-link">
  ES6详细版
</a></li></ul></div></div><div class="nav-item"><a href="/quweiqian/es6/intro.html" class="nav-link">
  es6阮
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/quweiqian/" class="nav-link">
  home
</a></div><div class="nav-item"><a href="/quweiqian/base/frontend-base-htmlcss-master/5/10.html" class="nav-link">
  基础
</a></div><div class="nav-item"><a href="/quweiqian/duyi/frontend-pre-htmlcss-master/01.html" class="nav-link">
  固定学习
</a></div><div class="nav-item"><a href="/quweiqian/interview/frontend-interview-html-master/1.html" class="nav-link">
  笔面试
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="context Menu" class="dropdown-title"><span class="title">详细版</span> <span class="arrow down"></span></button> <button type="button" aria-label="context Menu" class="mobile-dropdown-title"><span class="title">详细版</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/quweiqian/particular/frontend-es6-particular-master/1.html" class="nav-link">
  ES6详细版
</a></li></ul></div></div><div class="nav-item"><a href="/quweiqian/es6/intro.html" class="nav-link">
  es6阮
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/quweiqian/es6/intro" class="sidebar-heading clickable open"><span>es6阮一峰</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/quweiqian/es6/intro.html" class="sidebar-link">ECMAScript 6 简介</a></li><li><a href="/quweiqian/es6/let.html" class="sidebar-link">let 和 const 命令</a></li><li><a href="/quweiqian/es6/destructuring.html" class="sidebar-link">变量的解构赋值</a></li><li><a href="/quweiqian/es6/string.html" class="sidebar-link">字符串的扩展</a></li><li><a href="/quweiqian/es6/string-methods.html" class="sidebar-link">字符串的新增方法</a></li><li><a href="/quweiqian/es6/regex.html" class="sidebar-link">正则的扩展</a></li><li><a href="/quweiqian/es6/number.html" class="sidebar-link">数值的扩展</a></li><li><a href="/quweiqian/es6/function.html" class="sidebar-link">函数的扩展</a></li><li><a href="/quweiqian/es6/array.html" class="sidebar-link">数组的扩展</a></li><li><a href="/quweiqian/es6/object.html" class="sidebar-link">对象的扩展</a></li><li><a href="/quweiqian/es6/object-methods.html" class="sidebar-link">对象的新增方法</a></li><li><a href="/quweiqian/es6/operator.html" class="sidebar-link">运算符的扩展</a></li><li><a href="/quweiqian/es6/symbol.html" aria-current="page" class="active sidebar-link">Symbol</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/quweiqian/es6/symbol.html#概述" class="sidebar-link">概述</a></li><li class="sidebar-sub-header"><a href="/quweiqian/es6/symbol.html#symbol-prototype-description" class="sidebar-link">Symbol.prototype.description</a></li><li class="sidebar-sub-header"><a href="/quweiqian/es6/symbol.html#作为属性名的-symbol" class="sidebar-link">作为属性名的 Symbol</a></li><li class="sidebar-sub-header"><a href="/quweiqian/es6/symbol.html#实例-消除魔术字符串" class="sidebar-link">实例：消除魔术字符串</a></li><li class="sidebar-sub-header"><a href="/quweiqian/es6/symbol.html#属性名的遍历" class="sidebar-link">属性名的遍历</a></li><li class="sidebar-sub-header"><a href="/quweiqian/es6/symbol.html#symbol-for-symbol-keyfor" class="sidebar-link">Symbol.for()，Symbol.keyFor()</a></li><li class="sidebar-sub-header"><a href="/quweiqian/es6/symbol.html#实例-模块的-singleton-模式" class="sidebar-link">实例：模块的 Singleton 模式</a></li><li class="sidebar-sub-header"><a href="/quweiqian/es6/symbol.html#内置的-symbol-值" class="sidebar-link">内置的 Symbol 值</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/quweiqian/es6/symbol.html#symbol-hasinstance" class="sidebar-link">Symbol.hasInstance</a></li><li class="sidebar-sub-header"><a href="/quweiqian/es6/symbol.html#symbol-isconcatspreadable" class="sidebar-link">Symbol.isConcatSpreadable</a></li><li class="sidebar-sub-header"><a href="/quweiqian/es6/symbol.html#symbol-species" class="sidebar-link">Symbol.species</a></li><li class="sidebar-sub-header"><a href="/quweiqian/es6/symbol.html#symbol-match" class="sidebar-link">Symbol.match</a></li><li class="sidebar-sub-header"><a href="/quweiqian/es6/symbol.html#symbol-replace" class="sidebar-link">Symbol.replace</a></li><li class="sidebar-sub-header"><a href="/quweiqian/es6/symbol.html#symbol-search" class="sidebar-link">Symbol.search</a></li><li class="sidebar-sub-header"><a href="/quweiqian/es6/symbol.html#symbol-split" class="sidebar-link">Symbol.split</a></li><li class="sidebar-sub-header"><a href="/quweiqian/es6/symbol.html#symbol-iterator" class="sidebar-link">Symbol.iterator</a></li><li class="sidebar-sub-header"><a href="/quweiqian/es6/symbol.html#symbol-toprimitive" class="sidebar-link">Symbol.toPrimitive</a></li><li class="sidebar-sub-header"><a href="/quweiqian/es6/symbol.html#symbol-tostringtag" class="sidebar-link">Symbol.toStringTag</a></li><li class="sidebar-sub-header"><a href="/quweiqian/es6/symbol.html#symbol-unscopables" class="sidebar-link">Symbol.unscopables</a></li></ul></li></ul></li><li><a href="/quweiqian/es6/set-map.html" class="sidebar-link">Set 和 Map 数据结构</a></li><li><a href="/quweiqian/es6/proxy.html" class="sidebar-link">Proxy</a></li><li><a href="/quweiqian/es6/reflect.html" class="sidebar-link">Reflect</a></li><li><a href="/quweiqian/es6/promise.html" class="sidebar-link">Promise 对象</a></li><li><a href="/quweiqian/es6/iterator.html" class="sidebar-link">Iterator 和 for...of 循环</a></li><li><a href="/quweiqian/es6/generator.html" class="sidebar-link">Generator 函数的语法</a></li><li><a href="/quweiqian/es6/generator-async.html" class="sidebar-link">Generator 函数的异步应用</a></li><li><a href="/quweiqian/es6/async.html" class="sidebar-link">async 函数</a></li><li><a href="/quweiqian/es6/class.html" class="sidebar-link">Class 的基本语法</a></li><li><a href="/quweiqian/es6/class-extends.html" class="sidebar-link">Class 的继承</a></li><li><a href="/quweiqian/es6/module.html" class="sidebar-link">Module 的语法</a></li><li><a href="/quweiqian/es6/module-loader.html" class="sidebar-link">Module 的加载实现</a></li><li><a href="/quweiqian/es6/style.html" class="sidebar-link">编程风格</a></li><li><a href="/quweiqian/es6/spec.html" class="sidebar-link">读懂 ECMAScript 规格</a></li><li><a href="/quweiqian/es6/async-iterator.html" class="sidebar-link">异步遍历器</a></li><li><a href="/quweiqian/es6/arraybuffer.html" class="sidebar-link">ArrayBuffer</a></li><li><a href="/quweiqian/es6/proposals.html" class="sidebar-link">最新提案</a></li><li><a href="/quweiqian/es6/decorator.html" class="sidebar-link">装饰器</a></li><li><a href="/quweiqian/es6/reference.html" class="sidebar-link">参考链接</a></li><li><a href="/quweiqian/es6/acknowledgment.html" class="sidebar-link">鸣谢</a></li><li><a href="/quweiqian/es6/fp.html" class="sidebar-link">函数式编程</a></li><li><a href="/quweiqian/es6/mixin.html" class="sidebar-link">Mixin</a></li><li><a href="/quweiqian/es6/simd.html" class="sidebar-link">SIMD</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="symbol"><a href="#symbol" class="header-anchor">#</a> Symbol</h1> <h2 id="概述"><a href="#概述" class="header-anchor">#</a> 概述</h2> <p>ES5 的对象属性名都是字符串，这容易造成属性名的冲突。比如，你使用了一个他人提供的对象，但又想为这个对象添加新的方法（mixin 模式），新方法的名字就有可能与现有方法产生冲突。如果有一种机制，保证每个属性的名字都是独一无二的就好了，这样就从根本上防止属性名的冲突。这就是 ES6 引入<code>Symbol</code>的原因。</p> <p>ES6 引入了一种新的原始数据类型<code>Symbol</code>，表示独一无二的值。它属于 JavaScript 语言的原生数据类型之一，其他数据类型是：<code>undefined</code>、<code>null</code>、布尔值（Boolean）、字符串（String）、数值（Number）、大整数（BigInt）、对象（Object）。</p> <p>Symbol 值通过<code>Symbol()</code>函数生成。这就是说，对象的属性名现在可以有两种类型，一种是原来就有的字符串，另一种就是新增的 Symbol 类型。凡是属性名属于 Symbol 类型，就都是独一无二的，可以保证不会与其他属性名产生冲突。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">typeof</span> s
<span class="token comment">// &quot;symbol&quot;</span>
</code></pre></div><p>上面代码中，变量<code>s</code>就是一个独一无二的值。<code>typeof</code>运算符的结果，表明变量<code>s</code>是 Symbol 数据类型，而不是字符串之类的其他类型。</p> <p>注意，<code>Symbol()</code>函数前不能使用<code>new</code>命令，否则会报错。这是因为生成的 Symbol 是一个原始类型的值，不是对象，所以不能使用<code>new</code>命令来调用。另外，由于 Symbol 值不是对象，所以也不能添加属性。基本上，它是一种类似于字符串的数据类型。</p> <p><code>Symbol()</code>函数可以接受一个字符串作为参数，表示对 Symbol 实例的描述。这主要是为了在控制台显示，或者转为字符串时，比较容易区分。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> s1 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> s2 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'bar'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

s1 <span class="token comment">// Symbol(foo)</span>
s2 <span class="token comment">// Symbol(bar)</span>

s1<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// &quot;Symbol(foo)&quot;</span>
s2<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// &quot;Symbol(bar)&quot;</span>
</code></pre></div><p>上面代码中，<code>s1</code>和<code>s2</code>是两个 Symbol 值。如果不加参数，它们在控制台的输出都是<code>Symbol()</code>，不利于区分。有了参数以后，就等于为它们加上了描述，输出的时候就能够分清，到底是哪一个值。</p> <p>如果 Symbol 的参数是一个对象，就会调用该对象的<code>toString()</code>方法，将其转为字符串，然后才生成一个 Symbol 值。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'abc'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> sym <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
sym <span class="token comment">// Symbol(abc)</span>
</code></pre></div><p>注意，<code>Symbol()</code>函数的参数只是表示对当前 Symbol 值的描述，因此相同参数的<code>Symbol</code>函数的返回值是不相等的。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 没有参数的情况</span>
<span class="token keyword">let</span> s1 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> s2 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

s1 <span class="token operator">===</span> s2 <span class="token comment">// false</span>

<span class="token comment">// 有参数的情况</span>
<span class="token keyword">let</span> s1 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> s2 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

s1 <span class="token operator">===</span> s2 <span class="token comment">// false</span>
</code></pre></div><p>上面代码中，<code>s1</code>和<code>s2</code>都是<code>Symbol()</code>函数的返回值，而且参数相同，但是它们是不相等的。事实上，如果调用100次<code>Symbol()</code>，会得到100个互不相等的值。</p> <p>Symbol 值不能与其他类型的值进行运算，会报错。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> sym <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'My symbol'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token string">&quot;your symbol is &quot;</span> <span class="token operator">+</span> sym
<span class="token comment">// TypeError: can't convert symbol to string</span>
<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">your symbol is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>sym<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
<span class="token comment">// TypeError: can't convert symbol to string</span>
</code></pre></div><p>但是，Symbol 值可以显式转为字符串。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> sym <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'My symbol'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">String</span><span class="token punctuation">(</span>sym<span class="token punctuation">)</span> <span class="token comment">// 'Symbol(My symbol)'</span>
sym<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 'Symbol(My symbol)'</span>
</code></pre></div><p>另外，Symbol 值也可以转为布尔值，但是不能转为数值。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> sym <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">Boolean</span><span class="token punctuation">(</span>sym<span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token operator">!</span>sym  <span class="token comment">// false</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>sym<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token function">Number</span><span class="token punctuation">(</span>sym<span class="token punctuation">)</span> <span class="token comment">// TypeError</span>
sym <span class="token operator">+</span> <span class="token number">2</span> <span class="token comment">// TypeError</span>
</code></pre></div><h2 id="symbol-prototype-description"><a href="#symbol-prototype-description" class="header-anchor">#</a> Symbol.prototype.description</h2> <p>前面说过，<code>Symbol()</code>函数创建 Symbol 值时，可以用参数添加一个描述。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> sym <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>上面代码中，<code>sym</code>这个值的描述就是字符串<code>foo</code>。</p> <p>但是，读取这个描述需要将 Symbol 显式转为字符串，即下面的写法。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> sym <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">String</span><span class="token punctuation">(</span>sym<span class="token punctuation">)</span> <span class="token comment">// &quot;Symbol(foo)&quot;</span>
sym<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// &quot;Symbol(foo)&quot;</span>
</code></pre></div><p>上面的用法不是很方便。<a href="https://github.com/tc39/proposal-Symbol-description" target="_blank" rel="noopener noreferrer">ES2019<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 提供了一个 Symbol 值的实例属性<code>description</code>，直接返回 Symbol 值的描述。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> sym <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

sym<span class="token punctuation">.</span>description <span class="token comment">// &quot;foo&quot;</span>
</code></pre></div><h2 id="作为属性名的-symbol"><a href="#作为属性名的-symbol" class="header-anchor">#</a> 作为属性名的 Symbol</h2> <p>由于每一个 Symbol 值都是不相等的，这意味着只要 Symbol 值作为标识符，用于对象的属性名，就能保证不会出现同名的属性。这对于一个对象由多个模块构成的情况非常有用，能防止某一个键被不小心改写或覆盖。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> mySymbol <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 第一种写法</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
a<span class="token punctuation">[</span>mySymbol<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Hello!'</span><span class="token punctuation">;</span>

<span class="token comment">// 第二种写法</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>mySymbol<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">'Hello!'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 第三种写法</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> mySymbol<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'Hello!'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 以上写法都得到同样结果</span>
a<span class="token punctuation">[</span>mySymbol<span class="token punctuation">]</span> <span class="token comment">// &quot;Hello!&quot;</span>
</code></pre></div><p>上面代码通过方括号结构和<code>Object.defineProperty()</code>方法，将对象的属性名指定为一个 Symbol 值。</p> <p>注意，Symbol 值作为对象属性名时，不能用点运算符。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> mySymbol <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

a<span class="token punctuation">.</span>mySymbol <span class="token operator">=</span> <span class="token string">'Hello!'</span><span class="token punctuation">;</span>
a<span class="token punctuation">[</span>mySymbol<span class="token punctuation">]</span> <span class="token comment">// undefined</span>
a<span class="token punctuation">[</span><span class="token string">'mySymbol'</span><span class="token punctuation">]</span> <span class="token comment">// &quot;Hello!&quot;</span>
</code></pre></div><p>上面代码中，因为点运算符后面总是字符串，所以不会读取<code>mySymbol</code>作为标识名所指代的那个值，导致<code>a</code>的属性名实际上是一个字符串，而不是一个 Symbol 值。</p> <p>同理，在对象的内部，使用 Symbol 值定义属性时，Symbol 值必须放在方括号之中。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

obj<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>上面代码中，如果<code>s</code>不放在方括号中，该属性的键名就是字符串<code>s</code>，而不是<code>s</code>所代表的那个 Symbol 值。</p> <p>采用增强的对象写法，上面代码的<code>obj</code>对象可以写得更简洁一些。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token parameter">arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>Symbol 类型还可以用于定义一组常量，保证这组常量的值都是不相等的。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> log <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

log<span class="token punctuation">.</span>levels <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">DEBUG</span><span class="token operator">:</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'debug'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token constant">INFO</span><span class="token operator">:</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'info'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token constant">WARN</span><span class="token operator">:</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'warn'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>log<span class="token punctuation">.</span>levels<span class="token punctuation">.</span><span class="token constant">DEBUG</span><span class="token punctuation">,</span> <span class="token string">'debug message'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>log<span class="token punctuation">.</span>levels<span class="token punctuation">.</span><span class="token constant">INFO</span><span class="token punctuation">,</span> <span class="token string">'info message'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>下面是另外一个例子。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token constant">COLOR_RED</span>    <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">COLOR_GREEN</span>  <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">getComplement</span><span class="token punctuation">(</span><span class="token parameter">color</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>color<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token constant">COLOR_RED</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token constant">COLOR_GREEN</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token constant">COLOR_GREEN</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token constant">COLOR_RED</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Undefined color'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>常量使用 Symbol 值最大的好处，就是其他任何值都不可能有相同的值了，因此可以保证上面的<code>switch</code>语句会按设计的方式工作。</p> <p>还有一点需要注意，Symbol 值作为属性名时，该属性还是公开属性，不是私有属性。</p> <h2 id="实例-消除魔术字符串"><a href="#实例-消除魔术字符串" class="header-anchor">#</a> 实例：消除魔术字符串</h2> <p>魔术字符串指的是，在代码之中多次出现、与代码形成强耦合的某一个具体的字符串或者数值。风格良好的代码，应该尽量消除魔术字符串，改由含义清晰的变量代替。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">getArea</span><span class="token punctuation">(</span><span class="token parameter">shape<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> area <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">switch</span> <span class="token punctuation">(</span>shape<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">'Triangle'</span><span class="token operator">:</span> <span class="token comment">// 魔术字符串</span>
      area <span class="token operator">=</span> <span class="token number">.5</span> <span class="token operator">*</span> options<span class="token punctuation">.</span>width <span class="token operator">*</span> options<span class="token punctuation">.</span>height<span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token comment">/* ... more code ... */</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> area<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">getArea</span><span class="token punctuation">(</span><span class="token string">'Triangle'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">100</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 魔术字符串</span>
</code></pre></div><p>上面代码中，字符串<code>Triangle</code>就是一个魔术字符串。它多次出现，与代码形成“强耦合”，不利于将来的修改和维护。</p> <p>常用的消除魔术字符串的方法，就是把它写成一个变量。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> shapeType <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">triangle</span><span class="token operator">:</span> <span class="token string">'Triangle'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">getArea</span><span class="token punctuation">(</span><span class="token parameter">shape<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> area <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>shape<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> shapeType<span class="token punctuation">.</span>triangle<span class="token operator">:</span>
      area <span class="token operator">=</span> <span class="token number">.5</span> <span class="token operator">*</span> options<span class="token punctuation">.</span>width <span class="token operator">*</span> options<span class="token punctuation">.</span>height<span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> area<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">getArea</span><span class="token punctuation">(</span>shapeType<span class="token punctuation">.</span>triangle<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">100</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>上面代码中，我们把<code>Triangle</code>写成<code>shapeType</code>对象的<code>triangle</code>属性，这样就消除了强耦合。</p> <p>如果仔细分析，可以发现<code>shapeType.triangle</code>等于哪个值并不重要，只要确保不会跟其他<code>shapeType</code>属性的值冲突即可。因此，这里就很适合改用 Symbol 值。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> shapeType <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">triangle</span><span class="token operator">:</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>上面代码中，除了将<code>shapeType.triangle</code>的值设为一个 Symbol，其他地方都不用修改。</p> <h2 id="属性名的遍历"><a href="#属性名的遍历" class="header-anchor">#</a> 属性名的遍历</h2> <p>Symbol 值作为属性名，遍历对象的时候，该属性不会出现在<code>for...in</code>、<code>for...of</code>循环中，也不会被<code>Object.keys()</code>、<code>Object.getOwnPropertyNames()</code>、<code>JSON.stringify()</code>返回。</p> <p>但是，它也不是私有属性，有一个<code>Object.getOwnPropertySymbols()</code>方法，可以获取指定对象的所有 Symbol 属性名。该方法返回一个数组，成员是当前对象的所有用作属性名的 Symbol 值。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

obj<span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Hello'</span><span class="token punctuation">;</span>
obj<span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'World'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> objectSymbols <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">getOwnPropertySymbols</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>

objectSymbols
<span class="token comment">// [Symbol(a), Symbol(b)]</span>
</code></pre></div><p>上面代码是<code>Object.getOwnPropertySymbols()</code>方法的示例，可以获取所有 Symbol 属性名。</p> <p>下面是另一个例子，<code>Object.getOwnPropertySymbols()</code>方法与<code>for...in</code>循环、<code>Object.getOwnPropertyNames</code>方法进行对比的例子。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

obj<span class="token punctuation">[</span>foo<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'bar'</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 无输出</span>
<span class="token punctuation">}</span>

Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyNames</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token comment">// []</span>
Object<span class="token punctuation">.</span><span class="token function">getOwnPropertySymbols</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token comment">// [Symbol(foo)]</span>
</code></pre></div><p>上面代码中，使用<code>for...in</code>循环和<code>Object.getOwnPropertyNames()</code>方法都得不到 Symbol 键名，需要使用<code>Object.getOwnPropertySymbols()</code>方法。</p> <p>另一个新的 API，<code>Reflect.ownKeys()</code>方法可以返回所有类型的键名，包括常规键名和 Symbol 键名。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'my_key'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token keyword">enum</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token literal-property property">nonEnum</span><span class="token operator">:</span> <span class="token number">3</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

Reflect<span class="token punctuation">.</span><span class="token function">ownKeys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
<span class="token comment">//  [&quot;enum&quot;, &quot;nonEnum&quot;, Symbol(my_key)]</span>
</code></pre></div><p>由于以 Symbol 值作为键名，不会被常规方法遍历得到。我们可以利用这个特性，为对象定义一些非私有的、但又希望只用于内部的方法。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> size <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'size'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Collection</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">[</span>size<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">[</span>size<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> item<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">[</span>size<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">static</span> <span class="token function">sizeOf</span><span class="token punctuation">(</span><span class="token parameter">instance</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> instance<span class="token punctuation">[</span>size<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Collection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Collection<span class="token punctuation">.</span><span class="token function">sizeOf</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token comment">// 0</span>

x<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Collection<span class="token punctuation">.</span><span class="token function">sizeOf</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token comment">// 1</span>

Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token comment">// ['0']</span>
Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyNames</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token comment">// ['0']</span>
Object<span class="token punctuation">.</span><span class="token function">getOwnPropertySymbols</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token comment">// [Symbol(size)]</span>
</code></pre></div><p>上面代码中，对象<code>x</code>的<code>size</code>属性是一个 Symbol 值，所以<code>Object.keys(x)</code>、<code>Object.getOwnPropertyNames(x)</code>都无法获取它。这就造成了一种非私有的内部方法的效果。</p> <h2 id="symbol-for-symbol-keyfor"><a href="#symbol-for-symbol-keyfor" class="header-anchor">#</a> Symbol.for()，Symbol.keyFor()</h2> <p>有时，我们希望重新使用同一个 Symbol 值，<code>Symbol.for()</code>方法可以做到这一点。它接受一个字符串作为参数，然后搜索有没有以该参数作为名称的 Symbol 值。如果有，就返回这个 Symbol 值，否则就新建一个以该字符串为名称的 Symbol 值，并将其注册到全局。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> s1 <span class="token operator">=</span> Symbol<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> s2 <span class="token operator">=</span> Symbol<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

s1 <span class="token operator">===</span> s2 <span class="token comment">// true</span>
</code></pre></div><p>上面代码中，<code>s1</code>和<code>s2</code>都是 Symbol 值，但是它们都是由同样参数的<code>Symbol.for</code>方法生成的，所以实际上是同一个值。</p> <p><code>Symbol.for()</code>与<code>Symbol()</code>这两种写法，都会生成新的 Symbol。它们的区别是，前者会被登记在全局环境中供搜索，后者不会。<code>Symbol.for()</code>不会每次调用就返回一个新的 Symbol 类型的值，而是会先检查给定的<code>key</code>是否已经存在，如果不存在才会新建一个值。比如，如果你调用<code>Symbol.for(&quot;cat&quot;)</code>30 次，每次都会返回同一个 Symbol 值，但是调用<code>Symbol(&quot;cat&quot;)</code>30 次，会返回 30 个不同的 Symbol 值。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>Symbol<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">&quot;bar&quot;</span><span class="token punctuation">)</span> <span class="token operator">===</span> Symbol<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">&quot;bar&quot;</span><span class="token punctuation">)</span>
<span class="token comment">// true</span>

<span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">&quot;bar&quot;</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">&quot;bar&quot;</span><span class="token punctuation">)</span>
<span class="token comment">// false</span>
</code></pre></div><p>上面代码中，由于<code>Symbol()</code>写法没有登记机制，所以每次调用都会返回一个不同的值。</p> <p><code>Symbol.keyFor()</code>方法返回一个已登记的 Symbol 类型值的<code>key</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> s1 <span class="token operator">=</span> Symbol<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Symbol<span class="token punctuation">.</span><span class="token function">keyFor</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span> <span class="token comment">// &quot;foo&quot;</span>

<span class="token keyword">let</span> s2 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Symbol<span class="token punctuation">.</span><span class="token function">keyFor</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span> <span class="token comment">// undefined</span>
</code></pre></div><p>上面代码中，变量<code>s2</code>属于未登记的 Symbol 值，所以返回<code>undefined</code>。</p> <p>注意，<code>Symbol.for()</code>为 Symbol 值登记的名字，是全局环境的，不管有没有在全局环境运行。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Symbol<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">'bar'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> x <span class="token operator">=</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> y <span class="token operator">=</span> Symbol<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">'bar'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x <span class="token operator">===</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><p>上面代码中，<code>Symbol.for('bar')</code>是函数内部运行的，但是生成的 Symbol 值是登记在全局环境的。所以，第二次运行<code>Symbol.for('bar')</code>可以取到这个 Symbol 值。</p> <p><code>Symbol.for()</code>的这个全局登记特性，可以用在不同的 iframe 或 service worker 中取到同一个值。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>iframe <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'iframe'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
iframe<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token function">String</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>location<span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>iframe<span class="token punctuation">)</span><span class="token punctuation">;</span>

iframe<span class="token punctuation">.</span>contentWindow<span class="token punctuation">.</span>Symbol<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span> <span class="token operator">===</span> Symbol<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span>
<span class="token comment">// true</span>
</code></pre></div><p>上面代码中，iframe 窗口生成的 Symbol 值，可以在主页面得到。</p> <h2 id="实例-模块的-singleton-模式"><a href="#实例-模块的-singleton-模式" class="header-anchor">#</a> 实例：模块的 Singleton 模式</h2> <p>Singleton 模式指的是调用一个类，任何时候返回的都是同一个实例。</p> <p>对于 Node 来说，模块文件可以看成是一个类。怎么保证每次执行这个模块文件，返回的都是同一个实例呢？</p> <p>很容易想到，可以把实例放到顶层对象<code>global</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// mod.js</span>
<span class="token keyword">function</span> <span class="token constant">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>foo <span class="token operator">=</span> <span class="token string">'hello'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>global<span class="token punctuation">.</span>_foo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  global<span class="token punctuation">.</span>_foo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> global<span class="token punctuation">.</span>_foo<span class="token punctuation">;</span>
</code></pre></div><p>然后，加载上面的<code>mod.js</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./mod.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>上面代码中，变量<code>a</code>任何时候加载的都是<code>A</code>的同一个实例。</p> <p>但是，这里有一个问题，全局变量<code>global._foo</code>是可写的，任何文件都可以修改。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>global<span class="token punctuation">.</span>_foo <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token string">'world'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./mod.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>上面的代码，会使得加载<code>mod.js</code>的脚本都失真。</p> <p>为了防止这种情况出现，我们就可以使用 Symbol。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// mod.js</span>
<span class="token keyword">const</span> <span class="token constant">FOO_KEY</span> <span class="token operator">=</span> Symbol<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token constant">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>foo <span class="token operator">=</span> <span class="token string">'hello'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>global<span class="token punctuation">[</span><span class="token constant">FOO_KEY</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  global<span class="token punctuation">[</span><span class="token constant">FOO_KEY</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> global<span class="token punctuation">[</span><span class="token constant">FOO_KEY</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>上面代码中，可以保证<code>global[FOO_KEY]</code>不会被无意间覆盖，但还是可以被改写。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>global<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token string">'world'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./mod.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>如果键名使用<code>Symbol</code>方法生成，那么外部将无法引用这个值，当然也就无法改写。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// mod.js</span>
<span class="token keyword">const</span> <span class="token constant">FOO_KEY</span> <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 后面代码相同 ……</span>
</code></pre></div><p>上面代码将导致其他脚本都无法引用<code>FOO_KEY</code>。但这样也有一个问题，就是如果多次执行这个脚本，每次得到的<code>FOO_KEY</code>都是不一样的。虽然 Node 会将脚本的执行结果缓存，一般情况下，不会多次执行同一个脚本，但是用户可以手动清除缓存，所以也不是绝对可靠。</p> <h2 id="内置的-symbol-值"><a href="#内置的-symbol-值" class="header-anchor">#</a> 内置的 Symbol 值</h2> <p>除了定义自己使用的 Symbol 值以外，ES6 还提供了 11 个内置的 Symbol 值，指向语言内部使用的方法。</p> <h3 id="symbol-hasinstance"><a href="#symbol-hasinstance" class="header-anchor">#</a> Symbol.hasInstance</h3> <p>对象的<code>Symbol.hasInstance</code>属性，指向一个内部方法。当其他对象使用<code>instanceof</code>运算符，判断是否为该对象的实例时，会调用这个方法。比如，<code>foo instanceof Foo</code>在语言内部，实际调用的是<code>Foo[Symbol.hasInstance](foo)</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">MyClass</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>hasInstance<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token parameter">foo</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> foo <span class="token keyword">instanceof</span> <span class="token class-name">Array</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token keyword">instanceof</span> <span class="token class-name">new</span> <span class="token function">MyClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre></div><p>上面代码中，<code>MyClass</code>是一个类，<code>new MyClass()</code>会返回一个实例。该实例的<code>Symbol.hasInstance</code>方法，会在进行<code>instanceof</code>运算时自动调用，判断左侧的运算子是否为<code>Array</code>的实例。</p> <p>下面是另一个例子。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Even</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>hasInstance<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">Number</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 等同于</span>
<span class="token keyword">const</span> Even <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>hasInstance<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">Number</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token number">1</span> <span class="token keyword">instanceof</span> <span class="token class-name">Even</span> <span class="token comment">// false</span>
<span class="token number">2</span> <span class="token keyword">instanceof</span> <span class="token class-name">Even</span> <span class="token comment">// true</span>
<span class="token number">12345</span> <span class="token keyword">instanceof</span> <span class="token class-name">Even</span> <span class="token comment">// false</span>
</code></pre></div><h3 id="symbol-isconcatspreadable"><a href="#symbol-isconcatspreadable" class="header-anchor">#</a> Symbol.isConcatSpreadable</h3> <p>对象的<code>Symbol.isConcatSpreadable</code>属性等于一个布尔值，表示该对象用于<code>Array.prototype.concat()</code>时，是否可以展开。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> arr1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>arr1<span class="token punctuation">,</span> <span class="token string">'e'</span><span class="token punctuation">)</span> <span class="token comment">// ['a', 'b', 'c', 'd', 'e']</span>
arr1<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>isConcatSpreadable<span class="token punctuation">]</span> <span class="token comment">// undefined</span>

<span class="token keyword">let</span> arr2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
arr2<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>isConcatSpreadable<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>arr2<span class="token punctuation">,</span> <span class="token string">'e'</span><span class="token punctuation">)</span> <span class="token comment">// ['a', 'b', ['c','d'], 'e']</span>
</code></pre></div><p>上面代码说明，数组的默认行为是可以展开，<code>Symbol.isConcatSpreadable</code>默认等于<code>undefined</code>。该属性等于<code>true</code>时，也有展开的效果。</p> <p>类似数组的对象正好相反，默认不展开。它的<code>Symbol.isConcatSpreadable</code>属性设为<code>true</code>，才可以展开。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">length</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">:</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span> <span class="token string">'d'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">'e'</span><span class="token punctuation">)</span> <span class="token comment">// ['a', 'b', obj, 'e']</span>

obj<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>isConcatSpreadable<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">'e'</span><span class="token punctuation">)</span> <span class="token comment">// ['a', 'b', 'c', 'd', 'e']</span>
</code></pre></div><p><code>Symbol.isConcatSpreadable</code>属性也可以定义在类里面。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">A1</span> <span class="token keyword">extends</span> <span class="token class-name">Array</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>isConcatSpreadable<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">A2</span> <span class="token keyword">extends</span> <span class="token class-name">Array</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">get</span> <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>isConcatSpreadable<span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> a1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">A1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
a1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
a1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> a2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">A2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
a2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
a2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>a1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>a2<span class="token punctuation">)</span>
<span class="token comment">// [1, 2, 3, 4, [5, 6]]</span>
</code></pre></div><p>上面代码中，类<code>A1</code>是可展开的，类<code>A2</code>是不可展开的，所以使用<code>concat</code>时有不一样的结果。</p> <p>注意，<code>Symbol.isConcatSpreadable</code>的位置差异，<code>A1</code>是定义在实例上，<code>A2</code>是定义在类本身，效果相同。</p> <h3 id="symbol-species"><a href="#symbol-species" class="header-anchor">#</a> Symbol.species</h3> <p>对象的<code>Symbol.species</code>属性，指向一个构造函数。创建衍生对象时，会使用该属性。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">MyArray</span> <span class="token keyword">extends</span> <span class="token class-name">Array</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyArray</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> b <span class="token operator">=</span> a<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">x</span> <span class="token operator">=&gt;</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> c <span class="token operator">=</span> a<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">x</span> <span class="token operator">=&gt;</span> x <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

b <span class="token keyword">instanceof</span> <span class="token class-name">MyArray</span> <span class="token comment">// true</span>
c <span class="token keyword">instanceof</span> <span class="token class-name">MyArray</span> <span class="token comment">// true</span>
</code></pre></div><p>上面代码中，子类<code>MyArray</code>继承了父类<code>Array</code>，<code>a</code>是<code>MyArray</code>的实例，<code>b</code>和<code>c</code>是<code>a</code>的衍生对象。你可能会认为，<code>b</code>和<code>c</code>都是调用数组方法生成的，所以应该是数组（<code>Array</code>的实例），但实际上它们也是<code>MyArray</code>的实例。</p> <p><code>Symbol.species</code>属性就是为了解决这个问题而提供的。现在，我们可以为<code>MyArray</code>设置<code>Symbol.species</code>属性。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">MyArray</span> <span class="token keyword">extends</span> <span class="token class-name">Array</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token keyword">get</span> <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>species<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> Array<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上面代码中，由于定义了<code>Symbol.species</code>属性，创建衍生对象时就会使用这个属性返回的函数，作为构造函数。这个例子也说明，定义<code>Symbol.species</code>属性要采用<code>get</code>取值器。默认的<code>Symbol.species</code>属性等同于下面的写法。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">static</span> <span class="token keyword">get</span> <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>species<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>现在，再来看前面的例子。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">MyArray</span> <span class="token keyword">extends</span> <span class="token class-name">Array</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token keyword">get</span> <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>species<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> Array<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> b <span class="token operator">=</span> a<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">x</span> <span class="token operator">=&gt;</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>

b <span class="token keyword">instanceof</span> <span class="token class-name">MyArray</span> <span class="token comment">// false</span>
b <span class="token keyword">instanceof</span> <span class="token class-name">Array</span> <span class="token comment">// true</span>
</code></pre></div><p>上面代码中，<code>a.map(x =&gt; x)</code>生成的衍生对象，就不是<code>MyArray</code>的实例，而直接就是<code>Array</code>的实例。</p> <p>再看一个例子。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">T1</span> <span class="token keyword">extends</span> <span class="token class-name">Promise</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">T2</span> <span class="token keyword">extends</span> <span class="token class-name">Promise</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token keyword">get</span> <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>species<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">new</span> <span class="token class-name">T1</span><span class="token punctuation">(</span><span class="token parameter">r</span> <span class="token operator">=&gt;</span> <span class="token function">r</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">v</span> <span class="token operator">=&gt;</span> v<span class="token punctuation">)</span> <span class="token keyword">instanceof</span> <span class="token class-name">T1</span> <span class="token comment">// true</span>
<span class="token keyword">new</span> <span class="token class-name">T2</span><span class="token punctuation">(</span><span class="token parameter">r</span> <span class="token operator">=&gt;</span> <span class="token function">r</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">v</span> <span class="token operator">=&gt;</span> v<span class="token punctuation">)</span> <span class="token keyword">instanceof</span> <span class="token class-name">T2</span> <span class="token comment">// false</span>
</code></pre></div><p>上面代码中，<code>T2</code>定义了<code>Symbol.species</code>属性，<code>T1</code>没有。结果就导致了创建衍生对象时（<code>then</code>方法），<code>T1</code>调用的是自身的构造方法，而<code>T2</code>调用的是<code>Promise</code>的构造方法。</p> <p>总之，<code>Symbol.species</code>的作用在于，实例对象在运行过程中，需要再次调用自身的构造函数时，会调用该属性指定的构造函数。它主要的用途是，有些类库是在基类的基础上修改的，那么子类使用继承的方法时，作者可能希望返回基类的实例，而不是子类的实例。</p> <h3 id="symbol-match"><a href="#symbol-match" class="header-anchor">#</a> Symbol.match</h3> <p>对象的<code>Symbol.match</code>属性，指向一个函数。当执行<code>str.match(myObject)</code>时，如果该属性存在，会调用它，返回该方法的返回值。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token class-name">String</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>regexp<span class="token punctuation">)</span>
<span class="token comment">// 等同于</span>
regexp<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>match<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">MyMatcher</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>match<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token parameter">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'hello world'</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token string">'e'</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyMatcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 1</span>
</code></pre></div><h3 id="symbol-replace"><a href="#symbol-replace" class="header-anchor">#</a> Symbol.replace</h3> <p>对象的<code>Symbol.replace</code>属性，指向一个方法，当该对象被<code>String.prototype.replace</code>方法调用时，会返回该方法的返回值。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token class-name">String</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>searchValue<span class="token punctuation">,</span> replaceValue<span class="token punctuation">)</span>
<span class="token comment">// 等同于</span>
searchValue<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>replace<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> replaceValue<span class="token punctuation">)</span>
</code></pre></div><p>下面是一个例子。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> x <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
x<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>replace<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>s</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token string">'Hello'</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token string">'World'</span><span class="token punctuation">)</span> <span class="token comment">// [&quot;Hello&quot;, &quot;World&quot;]</span>
</code></pre></div><p><code>Symbol.replace</code>方法会收到两个参数，第一个参数是<code>replace</code>方法正在作用的对象，上面例子是<code>Hello</code>，第二个参数是替换后的值，上面例子是<code>World</code>。</p> <h3 id="symbol-search"><a href="#symbol-search" class="header-anchor">#</a> Symbol.search</h3> <p>对象的<code>Symbol.search</code>属性，指向一个方法，当该对象被<code>String.prototype.search</code>方法调用时，会返回该方法的返回值。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token class-name">String</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>regexp<span class="token punctuation">)</span>
<span class="token comment">// 等同于</span>
regexp<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>search<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">MySearch</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>search<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token parameter">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> string<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token string">'foobar'</span><span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MySearch</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 0</span>
</code></pre></div><h3 id="symbol-split"><a href="#symbol-split" class="header-anchor">#</a> Symbol.split</h3> <p>对象的<code>Symbol.split</code>属性，指向一个方法，当该对象被<code>String.prototype.split</code>方法调用时，会返回该方法的返回值。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token class-name">String</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span>separator<span class="token punctuation">,</span> limit<span class="token punctuation">)</span>
<span class="token comment">// 等同于</span>
separator<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>split<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> limit<span class="token punctuation">)</span>
</code></pre></div><p>下面是一个例子。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">MySplitter</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>split<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token parameter">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> index <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> string<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>
      string<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">,</span>
      string<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span>index <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token string">'foobar'</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MySplitter</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// ['', 'bar']</span>

<span class="token string">'foobar'</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MySplitter</span><span class="token punctuation">(</span><span class="token string">'bar'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// ['foo', '']</span>

<span class="token string">'foobar'</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MySplitter</span><span class="token punctuation">(</span><span class="token string">'baz'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// 'foobar'</span>
</code></pre></div><p>上面方法使用<code>Symbol.split</code>方法，重新定义了字符串对象的<code>split</code>方法的行为，</p> <h3 id="symbol-iterator"><a href="#symbol-iterator" class="header-anchor">#</a> Symbol.iterator</h3> <p>对象的<code>Symbol.iterator</code>属性，指向该对象的默认遍历器方法。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> myIterable <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
myIterable<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">yield</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">yield</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">yield</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token punctuation">[</span><span class="token operator">...</span>myIterable<span class="token punctuation">]</span> <span class="token comment">// [1, 2, 3]</span>
</code></pre></div><p>对象进行<code>for...of</code>循环时，会调用<code>Symbol.iterator</code>方法，返回该对象的默认遍历器，详细介绍参见《Iterator 和 for...of 循环》一章。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Collection</span> <span class="token punctuation">{</span>
  <span class="token operator">*</span><span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">yield</span> <span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token operator">++</span>i<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> myCollection <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Collection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
myCollection<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
myCollection<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>

<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> value <span class="token keyword">of</span> myCollection<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 1</span>
<span class="token comment">// 2</span>
</code></pre></div><h3 id="symbol-toprimitive"><a href="#symbol-toprimitive" class="header-anchor">#</a> Symbol.toPrimitive</h3> <p>对象的<code>Symbol.toPrimitive</code>属性，指向一个方法。该对象被转为原始类型的值时，会调用这个方法，返回该对象对应的原始类型值。</p> <p><code>Symbol.toPrimitive</code>被调用时，会接受一个字符串参数，表示当前运算的模式，一共有三种模式。</p> <ul><li>Number：该场合需要转成数值</li> <li>String：该场合需要转成字符串</li> <li>Default：该场合可以转成数值，也可以转成字符串</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>toPrimitive<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token parameter">hint</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>hint<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token string">'number'</span><span class="token operator">:</span>
        <span class="token keyword">return</span> <span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">'string'</span><span class="token operator">:</span>
        <span class="token keyword">return</span> <span class="token string">'str'</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">'default'</span><span class="token operator">:</span>
        <span class="token keyword">return</span> <span class="token string">'default'</span><span class="token punctuation">;</span>
      <span class="token keyword">default</span><span class="token operator">:</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token number">2</span> <span class="token operator">*</span> obj <span class="token comment">// 246</span>
<span class="token number">3</span> <span class="token operator">+</span> obj <span class="token comment">// '3default'</span>
obj <span class="token operator">==</span> <span class="token string">'default'</span> <span class="token comment">// true</span>
<span class="token function">String</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token comment">// 'str'</span>
</code></pre></div><h3 id="symbol-tostringtag"><a href="#symbol-tostringtag" class="header-anchor">#</a> Symbol.toStringTag</h3> <p>对象的<code>Symbol.toStringTag</code>属性，指向一个方法。在该对象上面调用<code>Object.prototype.toString</code>方法时，如果这个属性存在，它的返回值会出现在<code>toString</code>方法返回的字符串之中，表示对象的类型。也就是说，这个属性可以用来定制<code>[object Object]</code>或<code>[object Array]</code>中<code>object</code>后面的那个字符串。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 例一</span>
<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>toStringTag<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">'Foo'</span><span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// &quot;[object Foo]&quot;</span>

<span class="token comment">// 例二</span>
<span class="token keyword">class</span> <span class="token class-name">Collection</span> <span class="token punctuation">{</span>
  <span class="token keyword">get</span> <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>toStringTag<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'xxx'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Collection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token comment">// &quot;[object xxx]&quot;</span>
</code></pre></div><p>ES6 新增内置对象的<code>Symbol.toStringTag</code>属性值如下。</p> <ul><li><code>JSON[Symbol.toStringTag]</code>：'JSON'</li> <li><code>Math[Symbol.toStringTag]</code>：'Math'</li> <li>Module 对象<code>M[Symbol.toStringTag]</code>：'Module'</li> <li><code>ArrayBuffer.prototype[Symbol.toStringTag]</code>：'ArrayBuffer'</li> <li><code>DataView.prototype[Symbol.toStringTag]</code>：'DataView'</li> <li><code>Map.prototype[Symbol.toStringTag]</code>：'Map'</li> <li><code>Promise.prototype[Symbol.toStringTag]</code>：'Promise'</li> <li><code>Set.prototype[Symbol.toStringTag]</code>：'Set'</li> <li><code>%TypedArray%.prototype[Symbol.toStringTag]</code>：'Uint8Array'等</li> <li><code>WeakMap.prototype[Symbol.toStringTag]</code>：'WeakMap'</li> <li><code>WeakSet.prototype[Symbol.toStringTag]</code>：'WeakSet'</li> <li><code>%MapIteratorPrototype%[Symbol.toStringTag]</code>：'Map Iterator'</li> <li><code>%SetIteratorPrototype%[Symbol.toStringTag]</code>：'Set Iterator'</li> <li><code>%StringIteratorPrototype%[Symbol.toStringTag]</code>：'String Iterator'</li> <li><code>Symbol.prototype[Symbol.toStringTag]</code>：'Symbol'</li> <li><code>Generator.prototype[Symbol.toStringTag]</code>：'Generator'</li> <li><code>GeneratorFunction.prototype[Symbol.toStringTag]</code>：'GeneratorFunction'</li></ul> <h3 id="symbol-unscopables"><a href="#symbol-unscopables" class="header-anchor">#</a> Symbol.unscopables</h3> <p>对象的<code>Symbol.unscopables</code>属性，指向一个对象。该对象指定了使用<code>with</code>关键字时，哪些属性会被<code>with</code>环境排除。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>unscopables<span class="token punctuation">]</span>
<span class="token comment">// {</span>
<span class="token comment">//   copyWithin: true,</span>
<span class="token comment">//   entries: true,</span>
<span class="token comment">//   fill: true,</span>
<span class="token comment">//   find: true,</span>
<span class="token comment">//   findIndex: true,</span>
<span class="token comment">//   includes: true,</span>
<span class="token comment">//   keys: true</span>
<span class="token comment">// }</span>

Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>unscopables<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">// ['copyWithin', 'entries', 'fill', 'find', 'findIndex', 'includes', 'keys']</span>
</code></pre></div><p>上面代码说明，数组有 7 个属性，会被<code>with</code>命令排除。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 没有 unscopables 时</span>
<span class="token keyword">class</span> <span class="token class-name">MyClass</span> <span class="token punctuation">{</span>
  <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">with</span> <span class="token punctuation">(</span><span class="token class-name">MyClass</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
<span class="token punctuation">}</span>

<span class="token comment">// 有 unscopables 时</span>
<span class="token keyword">class</span> <span class="token class-name">MyClass</span> <span class="token punctuation">{</span>
  <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
  <span class="token keyword">get</span> <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>unscopables<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">with</span> <span class="token punctuation">(</span><span class="token class-name">MyClass</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上面代码通过指定<code>Symbol.unscopables</code>属性，使得<code>with</code>语法块不会在当前作用域寻找<code>foo</code>属性，即<code>foo</code>将指向外层作用域的变量。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/quweiqian/es6/operator.html" class="prev">
        运算符的扩展
      </a></span> <span class="next"><a href="/quweiqian/es6/set-map.html">
        Set 和 Map 数据结构
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/quweiqian/assets/js/app.a7ba3ea9.js" defer></script><script src="/quweiqian/assets/js/4.1d87bada.js" defer></script><script src="/quweiqian/assets/js/168.9f8fbb5b.js" defer></script>
  </body>
</html>
