(window.webpackJsonp=window.webpackJsonp||[]).push([[509],{884:function(t,s,a){"use strict";a.r(s);var n=a(10),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"commonjs"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#commonjs"}},[t._v("#")]),t._v(" CommonJS")]),t._v(" "),s("p",[t._v("在nodejs中，由于有且仅有一个入口文件（启动文件），而开发一个应用肯定会涉及到多个文件配合，因此，nodejs对模块化的需求比浏览器端要大的多")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://qwq9527.gitee.io/resource/imgs/2019-12-02-11-15-01.png",alt:""}})]),t._v(" "),s("p",[t._v("由于nodejs刚刚发布的时候，前端没有统一的、官方的模块化规范，因此，它选择使用社区提供的CommonJS作为模块化规范")]),t._v(" "),s("p",[t._v("在学习CommonJS之前，首先认识两个重要的概念："),s("strong",[t._v("模块的导出")]),t._v("和"),s("strong",[t._v("模块的导入")])]),t._v(" "),s("h2",{attrs:{id:"模块的导出"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#模块的导出"}},[t._v("#")]),t._v(" 模块的导出")]),t._v(" "),s("p",[t._v("要理解模块的导出，首先要理解模块的含义")]),t._v(" "),s("p",[t._v("什么是模块？")]),t._v(" "),s("p",[t._v("模块就是一个JS文件，它实现了一部分功能，并隐藏自己的内部实现，同时提供了一些接口供其他模块使用")]),t._v(" "),s("p",[t._v("模块有两个核心要素："),s("strong",[t._v("隐藏")]),t._v("和"),s("strong",[t._v("暴露")])]),t._v(" "),s("p",[t._v("隐藏的，是自己内部的实现")]),t._v(" "),s("p",[t._v("暴露的，是希望外部使用的接口")]),t._v(" "),s("p",[t._v("任何一个正常的模块化标准，都应该默认隐藏模块中的所有实现，而通过一些语法或api调用来暴露接口")]),t._v(" "),s("p",[s("strong",[t._v("暴露接口的过程即模块的导出")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://qwq9527.gitee.io/resource/imgs/2019-12-02-11-27-12.png",alt:""}})]),t._v(" "),s("h2",{attrs:{id:"模块的导入"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#模块的导入"}},[t._v("#")]),t._v(" 模块的导入")]),t._v(" "),s("p",[t._v("当需要使用一个模块时，使用的是该模块暴露的部分（导出的部分），隐藏的部分是永远无法使用的。")]),t._v(" "),s("p",[s("strong",[t._v("当通过某种语法或api去使用一个模块时，这个过程叫做模块的导入")])]),t._v(" "),s("h2",{attrs:{id:"commonjs规范"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#commonjs规范"}},[t._v("#")]),t._v(" CommonJS规范")]),t._v(" "),s("p",[t._v("CommonJS使用"),s("code",[t._v("exports")]),t._v("导出模块，"),s("code",[t._v("require")]),t._v("导入模块")]),t._v(" "),s("p",[t._v("具体规范如下：")]),t._v(" "),s("ol",[s("li",[t._v("如果一个JS文件中存在"),s("code",[t._v("exports")]),t._v("或"),s("code",[t._v("require")]),t._v("，该JS文件是一个模块")]),t._v(" "),s("li",[t._v("模块内的所有代码均为隐藏代码，包括全局变量、全局函数，这些全局的内容均不应该对全局变量造成任何污染")]),t._v(" "),s("li",[t._v("如果一个模块需要暴露一些API提供给外部使用，需要通过"),s("code",[t._v("exports")]),t._v("导出，"),s("code",[t._v("exports")]),t._v("是一个空的对象，你可以为该对象添加任何需要导出的内容")]),t._v(" "),s("li",[t._v("如果一个模块需要导入其他模块，通过"),s("code",[t._v("require")]),t._v("实现，"),s("code",[t._v("require")]),t._v("是一个函数，传入模块的路径即可返回该模块导出的整个内容")])]),t._v(" "),s("h2",{attrs:{id:"nodejs对commonjs的实现"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nodejs对commonjs的实现"}},[t._v("#")]),t._v(" nodejs对CommonJS的实现")]),t._v(" "),s("p",[t._v("为了实现CommonJS规范，nodejs对模块做出了以下处理")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("为了保证高效的执行，仅加载必要的模块。nodejs只有执行到"),s("code",[t._v("require")]),t._v("函数时才会加载并执行模块")])]),t._v(" "),s("li",[s("p",[t._v("为了隐藏模块中的代码，nodejs执行模块时，会将模块中的所有代码放置到一个函数中执行，以保证不污染全局变量。")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//模块中的代码")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),s("li",[s("p",[t._v("为了保证顺利的导出模块内容，nodejs做了以下处理")]),t._v(" "),s("ol",[s("li",[t._v("在模块开始执行前，初始化一个值"),s("code",[t._v("module.exports = {}")])]),t._v(" "),s("li",[s("code",[t._v("module.exports")]),t._v("即模块的导出值")]),t._v(" "),s("li",[t._v("为了方便开发者便捷的导出，nodejs在初始化完"),s("code",[t._v("module.exports")]),t._v("后，又声明了一个变量"),s("code",[t._v("exports = module.exports")])])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("module")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//模块中的代码")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),s("li",[s("p",[t._v("为了避免反复加载同一个模块，nodejs默认开启了模块缓存，如果加载的模块已经被加载过了，则会自动使用之前的导出结果")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);