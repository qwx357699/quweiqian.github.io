(window.webpackJsonp=window.webpackJsonp||[]).push([[609],{980:function(s,t,a){"use strict";a.r(t);var e=a(10),n=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"在-node-中搭建-ts-开发环境"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#在-node-中搭建-ts-开发环境"}},[s._v("#")]),s._v(" 在 node 中搭建 TS 开发环境")]),s._v(" "),t("h2",{attrs:{id:"安装-typescript"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装-typescript"}},[s._v("#")]),s._v(" 安装 TypeScript")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-g")]),s._v(" typescript\n")])])]),t("p",[s._v("默认情况下，TS 会做出下面几种假设：")]),s._v(" "),t("ol",[t("li",[s._v("假设当前的执行环境是 dom")]),s._v(" "),t("li",[s._v("如果代码中没有使用模块化语句（import、export），便认为该代码是全局执行")]),s._v(" "),t("li",[s._v("编译的目标代码是 ES3")])]),s._v(" "),t("p",[s._v("有两种方式更改以上假设：")]),s._v(" "),t("ol",[t("li",[s._v("使用 tsc 命令行的时候，加上选项参数")]),s._v(" "),t("li",[s._v("使用 ts 配置文件，更改编译选项,使用 "),t("code",[s._v("tsc --init")]),s._v(" 命令初始化配置文件，生成 "),t("code",[s._v("tsconfig.json")]),s._v("文件。")])]),s._v(" "),t("h2",{attrs:{id:"ts-的配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ts-的配置文件"}},[s._v("#")]),s._v(" TS 的配置文件")]),s._v(" "),t("p",[t("strong",[s._v("使用了配置文件后，使用 tsc 进行编译时，不能跟上文件名，如果跟上文件名，会忽略配置文件")]),s._v("。")]),s._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"compilerOptions"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//编译选项")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"target"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"es2016"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//配置编译目标代码的版本标准")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"module"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"commonjs"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//配置编译目标使用的模块化标准")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"lib"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"es2016"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"outDir"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./dist"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"include"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./src"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 指定tsc编译的文件夹")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// "files": ["./src/index.ts"]')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("p",[s._v("这时文件中写 "),t("code",[s._v("console.log()")]),s._v(" 会报错，根据 lib 的配置，去掉了浏览器环境，这时应该加上 node 环境，但是 lib 配置不了 node 环境。\n这时，需要安装第三方库 "),t("code",[s._v("@type/node")]),s._v("。")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" i @types/node "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-D")]),s._v("\n")])])]),t("h3",{attrs:{id:"type-是什么"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#type-是什么"}},[s._v("#")]),s._v(" @type 是什么？")]),s._v(" "),t("p",[s._v("@types 是一个 ts 官方的类型库，其中包含了很多对 js 代码的类型描述。")]),s._v(" "),t("p",[s._v("有的第三库是 js 写的，能在 ts 里面使用，但是没有类型检查。所以需要去 "),t("code",[s._v("@types")]),s._v(" 库中找一找又没有对应的类型。\n比如 Jquery：")]),s._v(" "),t("blockquote",[t("p",[s._v("JQuery：用 js 写的，没有类型检查\n安装@types/jquery，为 jquery 库添加类型定义")])]),s._v(" "),t("p",[t("a",{attrs:{href:"https://www.jeffreythomas.dev/typescript/yarn/yarn3/nodejs/2022/08/01/typescript-project-yarn-3.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("yarn 中安装设置 ts"),t("OutboundLink")],1)]),s._v(" "),t("h3",{attrs:{id:"指定编译目录和文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#指定编译目录和文件"}},[s._v("#")]),s._v(" 指定编译目录和文件")]),s._v(" "),t("p",[s._v("使用 "),t("code",[s._v("tsc")]),s._v(" 命令默认编译根目录所有目录 ts 文件。")]),s._v(" "),t("ul",[t("li",[s._v("指定目录\n设置 "),t("code",[s._v("include")]),s._v(" 可指定目录进行编译，可以配置多个文件夹")]),s._v(" "),t("li",[s._v("指定文件\n设置 "),t("code",[s._v("files")]),s._v(" 指定的文件和相关依赖的文件进行编译。类似入口文件。")])]),s._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"compilerOptions"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"include"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./src"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 指定tsc编译的文件夹")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"files"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./src/index.ts"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 指定文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("h3",{attrs:{id:"指定输出的目录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#指定输出的目录"}},[s._v("#")]),s._v(" 指定输出的目录")]),s._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"compilerOptions"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"outDir"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./dist"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("h2",{attrs:{id:"使用第三方库简化流程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用第三方库简化流程"}},[s._v("#")]),s._v(" 使用第三方库简化流程")]),s._v(" "),t("p",[s._v("运行 ts 问题：")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("tsc\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("node")]),s._v(" ./dist/index.js\n")])])]),t("p",[s._v("需要先将 ts 编译成 js 再运行,比较繁琐。\n所以需要第三方库帮我们处理编译、执行、监测代码改动。")]),s._v(" "),t("p",[s._v("介绍一些第三方库：")]),s._v(" "),t("ul",[t("li",[t("p",[t("strong",[s._v("ts-node")]),s._v("\n将 ts 代码在内存中完成编译，同时完成运行，不生成文件，符合我们开发的需要。")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("ts-node src/index.ts\n")])])]),t("p",[s._v("这里需要指定一个文件，相当于一个入口，该命令会按照 "),t("code",[s._v("tsconfig.json")]),s._v(" 配置运行。")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("nodemon")]),s._v("\n用于检测文件的变化，在内存完成编译，然后输出结果。")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("nodemon "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--exec")]),s._v(" ts-node src/index.ts\n")])])]),t("p",[s._v("表示：监测文件的变化，当文件变化时，执行 "),t("code",[s._v("--exec")]),s._v(" "),t("code",[s._v("ts-node")]),s._v("这个命令，然后 "),t("code",[s._v("ts-node")]),s._v(" 执行 "),t("code",[s._v("src/index.ts")]),s._v("。\n命令太长，可以配置到 "),t("code",[s._v("package.json")]),s._v(" "),t("code",[s._v("scripts")]),s._v(" 中。")]),s._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"dev"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nodemon --exec ts-node src/index.ts"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("ul",[t("li",[t("p",[s._v("细节 1-指定监控文件类型\n但是 "),t("code",[s._v("nodemon")]),s._v(" 命令监测文件范围有点广，例如改动 "),t("code",[s._v("package.json")]),s._v(" 文件，也会编译，因此需要限制。\n在 "),t("code",[s._v("nodemon")]),s._v(" 命令后面加 "),t("code",[s._v("-e")]),s._v(" 表示文件的扩展名。")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("nodemon "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" ts "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--exec")]),s._v(" ts-node src/index.ts\n")])])]),t("p",[t("a",{attrs:{href:"https://www.zhihu.com/question/267095526/answers/updated",target:"_blank",rel:"noopener noreferrer"}},[s._v("命令行参数前的「-」和「--」有什么区别？"),t("OutboundLink")],1)])]),s._v(" "),t("li",[t("p",[s._v("细节 2-指定监控文件范围\n在 "),t("code",[s._v("nodemon")]),s._v(" 命令后面加 "),t("code",[s._v("--watch 目录")]),s._v(" 表示文件的目录。")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("nodemon "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--watch")]),s._v(" src "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" ts "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--exec")]),s._v(" ts-node src\n")])])]),t("p",[s._v("表示监控 src 目录下的 ts 文件")])])])])])])}),[],!1,null,null,null);t.default=n.exports}}]);