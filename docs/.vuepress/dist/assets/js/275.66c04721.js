(window.webpackJsonp=window.webpackJsonp||[]).push([[275],{646:function(v,_,p){"use strict";p.r(_);var t=p(10),i=Object(t.a)({},(function(){var v=this,_=v._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[_("h1",{attrs:{id:"网络性能优化"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#网络性能优化"}},[v._v("#")]),v._v(" 网络性能优化")]),v._v(" "),_("p",[v._v("列举优化网络性能方法")]),v._v(" "),_("blockquote",[_("p",[v._v("参考答案：")]),v._v(" "),_("ul",[_("li",[_("p",[v._v("优化打包体积")]),v._v(" "),_("p",[v._v("利用一些工具压缩、混淆最终打包代码，减少包体积")])]),v._v(" "),_("li",[_("p",[v._v("多目标打包")]),v._v(" "),_("p",[v._v("利用一些打包插件，针对不同的浏览器打包出不同的兼容性版本，这样一来，每个版本中的兼容性代码就会大大减少，从而减少包体积")])]),v._v(" "),_("li",[_("p",[v._v("压缩")]),v._v(" "),_("p",[v._v("现代浏览器普遍支持压缩格式，因此服务端的各种文件可以压缩后再响应给客户端，只要解压时间小于优化的传输时间，压缩就是可行的")])]),v._v(" "),_("li",[_("p",[v._v("CDN")]),v._v(" "),_("p",[v._v("利用 CDN 可以大幅缩减静态资源的访问时间，特别是对于公共库的访问，可以使用知名的 CDN 资源，这样可以实现跨越站点的缓存")])]),v._v(" "),_("li",[_("p",[v._v("缓存")]),v._v(" "),_("p",[v._v("对于除 HTML 外的所有静态资源均可以开启协商缓存，利用构建工具打包产生的文件 hash 值来置换缓存")])]),v._v(" "),_("li",[_("p",[v._v("http2")]),v._v(" "),_("p",[v._v("开启 http2 后，利用其多路复用、头部压缩等特点，充分利用带宽传递大量的文件数据")])]),v._v(" "),_("li",[_("p",[v._v("雪碧图")]),v._v(" "),_("p",[v._v("对于不使用 HTTP2 的场景，可以将多个图片合并为雪碧图，以达到减少文件的目的")])]),v._v(" "),_("li",[_("p",[v._v("defer、async")]),v._v(" "),_("p",[v._v("通过 defer 和 async 属性，可以让页面尽早加载 js 文件")])]),v._v(" "),_("li",[_("p",[v._v("prefetch、preload")]),v._v(" "),_("p",[v._v("通过 prefetch 属性，可以让页面在空闲时预先下载其他页面可能要用到的资源")]),v._v(" "),_("p",[v._v("通过 preload 属性，可以让页面预先下载本页面可能要用到的资源")])]),v._v(" "),_("li",[_("p",[v._v("多个静态资源域")]),v._v(" "),_("p",[v._v("对于不使用 HTTP2 的场景，将相对独立的静态资源分到多个域中保存，可以让浏览器同时开启多个 TCP 连接，并行下载")])])])]),v._v(" "),_("hr"),v._v(" "),_("p",[_("em",[v._v("补充：")])]),v._v(" "),_("p",[v._v("网络性能优化无非就是让网络传输的更快，或者利用一些手段让某些东西不传输。")]),v._v(" "),_("ol",[_("li",[_("p",[v._v("优化打包体积")]),v._v(" "),_("p",[v._v("最重要的是优化打包体积。"),_("strong",[v._v("混淆")]),v._v("不仅能不易阅读代码，这里还有个作用：将很长的变量名缩短，从而优化体积。")]),v._v(" "),_("p",[v._v("例如有个 1M 的 js 文件，经过压缩混淆变成 500kb ，再用 gzip 压缩，可能变成 100kb，体积小了，传输的时间自然就短了。")])]),v._v(" "),_("li",[_("p",[v._v("多目标打包")]),v._v(" "),_("p",[v._v("因为兼容问题，比如某些 api 旧浏览器不支持，babel 处理后，造成打包代码体积过大，但是对于现代浏览器直接支持这些 api ，就没有必要进行兼容处理，所以针对不同浏览器做不同的打包处理。")]),v._v(" "),_("p",[v._v("如 vue-cli 中的 "),_("code",[v._v("vue-cli-service build --modern")]),v._v(" 见  "),_("RouterLink",{attrs:{to:"/quweiqian/duyi/frontend-training-master/vue26.html#启用现代模式"}},[v._v("打包优化 | 无间劫 (gitee.io)")])],1)]),v._v(" "),_("li",[_("p",[v._v("压缩")]),v._v(" "),_("p",[v._v("怎么压缩，各种压缩算法总的思维都差不多，举个例子：")]),v._v(" "),_("p",[v._v("如有一个字符串 abcdafaa; 怎么压缩呢，将会记录一个")]),v._v(" "),_("p",[v._v("a:0,4,6,7;b:2;c:3,...")]),v._v(" "),_("p",[v._v("将每个出现的字母出现位置记录下来，因为字母是 ASCII 编码，占用一个字节，用数据记录将会小的多。")]),v._v(" "),_("p",[v._v("解压缩，将上面数据还原成字符串。")]),v._v(" "),_("p",[v._v("压缩算法有很多，gzip 是其中一个，现在浏览器都基本支持该算法，所以网络传输时，可以直接发一个 gizp 压缩包过去，这个不是前端的工作，是运维部署时的工作。")]),v._v(" "),_("p",[v._v("gzip 不是减少打包体积，而是减少传输体积。")])]),v._v(" "),_("li",[_("p",[v._v("cdn")]),v._v(" "),_("p",[v._v("同时访问同一个服务器，会造成占用带宽太多了，导致响应数据不及时。那么 cdn 就是解决这个问题的，在世界各地部署多个 cdn 服务器，cdn 服务器定期从服务器中获取最新内容，用户下次请求时，静态资源直接从最近的 cdn 服务器获取，不仅减轻服务器压力，而且传输的距离更短。")]),v._v(" "),_("p",[v._v("会有些问题，服务器更新，cdn 不能及时更新，之前项目遇到过，里面提供的通知 cdn 强制刷新功能。")]),v._v(" "),_("p",[v._v("cdn 还有个特点，请求 cdn 返回信息给浏览器加了缓存，缓存事时间很久，主要托管基本不怎么变化的静态资源")]),v._v(" "),_("p",[v._v("跨网站共享啥意思：譬如公共的第三库，vue、jquery、moment 等，那么就可以直接使用，假设请求某个网站，里面用到了 cdn 的 vue 库，之前访问别的网站，里面也用了 cdn 提供 vue 库，那么浏览器已经缓存过，这时就不需要下载，直接使用缓存即可。这就是跨站点缓存。")])]),v._v(" "),_("li",[_("p",[v._v("缓存")])]),v._v(" "),_("li",[_("p",[v._v("http2")]),v._v(" "),_("p",[v._v("需要运维开启，如网页内有很多 图片、css 、js 等情况开启。")])]),v._v(" "),_("li",[_("p",[v._v("雪碧图")]),v._v(" "),_("ol",[_("li",[v._v("使用 http2 就不需要了，")]),v._v(" "),_("li",[v._v("为了兼容性，现在浏览器使用 http2，就浏览器还是使用雪碧图方案，所以该方案将会存在一段时间")]),v._v(" "),_("li",[v._v("1000 次请求图标，和一张雪碧图，内容都一样大，可能雪碧图还要大点，但是多次请求 tcp 不断握手挥手都是需要消耗时间。")])])]),v._v(" "),_("li",[_("p",[v._v("多个静态资源域")]),v._v(" "),_("p",[v._v("http2 以前，http1.0,http1.1;浏览器对 tcp 连接开启数量是有限制的，一般 6 个。")]),v._v(" "),_("p",[v._v("如果一个网站有很多资源要加载，假设 1-100 个图片，浏览器将会将这些图片进行分组，假设分成 1-33，34-67，...")]),v._v(" "),_("p",[v._v("那么 请求时，每组都是 1 个 tcp 连接的排队传输的。1 和 34 张图片可能同时进行。")]),v._v(" "),_("p",[v._v("假设资源非常多，6 个也不够用，后来发现这个限制是针对域名的，每个域名 6 个 tcp 连接。")]),v._v(" "),_("p",[v._v("所以将 静态资源分别部署在不同的域名下，请求时能同时开启多个 tcp 下载。")]),v._v(" "),_("p",[v._v("chrome 网络调试工具中 connectionId 相同表示用的是同一个连接（表示开启长连接，http1.1 默认开启，http1.0 使用非标，见 http各版本差异章节）。")])])]),v._v(" "),_("hr")])}),[],!1,null,null,null);_.default=i.exports}}]);