(window.webpackJsonp=window.webpackJsonp||[]).push([[545],{916:function(t,s,a){"use strict";a.r(s);var e=a(10),r=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"入口和出口的最佳实践-ignore"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#入口和出口的最佳实践-ignore"}},[t._v("#")]),t._v(" 入口和出口的最佳实践 {ignore}")]),t._v(" "),s("p",[t._v("上节课讲了入口和出口的配置，那么项目中应该怎么配置呢？")]),t._v(" "),s("p",[t._v("没有固定答案，需要具体情况具体分析。")]),t._v(" "),s("p",[s("em",[t._v("wepack")]),t._v(" 难点在于如何去用，"),s("em",[t._v("vue")]),t._v(" 和 "),s("em",[t._v("react")]),t._v(" 框架已经提供了最佳实践方案。那么学习 "),s("em",[t._v("webpack")]),t._v(" 的意义在哪呢？")]),t._v(" "),s("p",[t._v("主要是为了理解这些框架到底是怎么工作的，怎么运行的。")]),t._v(" "),s("p",[t._v("这节课的意义在于让我们了解大致 "),s("em",[t._v("webpack")]),t._v(" 是怎么用的，有了一个初步的认识，对之前的知识进行巩固和复习。")]),t._v(" "),s("p",[t._v("下面是一些经典场景")]),t._v(" "),s("h2",{attrs:{id:"一个页面一个js"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一个页面一个js"}},[t._v("#")]),t._v(" 一个页面一个JS")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://qwq9527.gitee.io/resource/imgs//2020-01-10-12-00-28.png",alt:""}})]),t._v(" "),s("p",[t._v("源码结构大致这样，这里只列出页面的启动模块。")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("|—— src\n    |—— pageA   页面A的代码目录\n        |—— index.js 页面A的启动模块\n        |—— ...\n    |—— pageB   页面B的代码目录\n        |—— index.js 页面B的启动模块\n        |—— ...\n    |—— pageC   页面C的代码目录\n        |—— main1.js 页面C的启动模块1 例如：主功能\n        |—— main2.js 页面C的启动模块2 例如：实现访问统计的额外功能\n        |—— ...\n    |—— common  公共代码目录\n        |—— ...\n")])])]),s("p",[s("em",[t._v("页面C")]),t._v("有一个额外的统计功能，"),s("em",[t._v("common")]),t._v(" 模块提供公共代码，"),s("em",[t._v("页面A、B、C")]),t._v(" 都会用到，大致这个情况。")]),t._v(" "),s("p",[t._v("webpack配置")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("entry")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("pageA")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./src/pageA/index.js"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("pageB")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./src/pageB/index.js"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("pageC")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./src/pageC/main1.js"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./src/pageC/main2.js"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("output")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("filename")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"[name].[chunkhash:5].js"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("这种方式适用于"),s("strong",[t._v("页面之间的功能差异巨大")]),t._v("、"),s("strong",[t._v("公共代码较少的情况")]),t._v("，这种情况下打包出来的最终代码不会有太多重复。")]),t._v(" "),s("p",[t._v("差异巨大值指的是：比如 "),s("em",[t._v("页面A")]),t._v(" 是抽奖页面，"),s("em",[t._v("页面C")]),t._v(" 是新闻页面，两个页面基本不相干，没啥复用功能。")]),t._v(" "),s("p",[t._v("公共代码较少：有个问题，这3个文件都有公共代码，"),s("strong",[t._v("这些公共代码会造成什么影响")]),t._v("？")]),t._v(" "),s("p",[t._v("不好维护，要导出改动？不存在的，这里"),s("em",[t._v("js")]),t._v("文件是打包的结果，只需要维护一份源码即可。那会造成什么影响？")]),t._v(" "),s("p",[t._v("导致传输量增加的问题。比如先后访问这三个页面，每个页面对应的 "),s("em",[t._v("js")]),t._v(" 里面都有重复的代码。例如：")]),t._v(" "),s("div",{staticClass:"language-tex extra-class"},[s("pre",{pre:!0,attrs:{class:"language-tex"}},[s("code",[t._v("公共代码：4KB\n页面A: 10kB + 4KB\n页面B: 10kB + 4KB\n页面C: 10kB + 4KB\n")])])]),s("p",[t._v("总共："),s("code",[t._v("14*3=42KB")]),t._v("，如果想办法将公共代码抽离出成一个文件，"),s("em",[t._v("页面A")]),t._v(" 引入两个代码，一个是重复代码，另一个是自己的代码。")]),t._v(" "),s("p",[t._v("最终总共有"),s("code",[t._v("34KB")]),t._v("的代码，虽然每个页面引入的代码不变，但是重复代码会缓存下来。")]),t._v(" "),s("p",[t._v("重复的代码越多，对传输量影响越大。所以说这种情况只能适用于重复代码比较少的情况。")]),t._v(" "),s("p",[t._v("那么重复代码多怎么解决呢？需要看后续的优化章节。")]),t._v(" "),s("p",[t._v("那么能不能使用多入模块入口进行打包呢？")]),t._v(" "),s("p",[t._v("也不行，根据上一章内容，多模块入口只是分析依赖关系，最终打包代码一个函数内运行，页面的代码用不到这个模块的变量。")]),t._v(" "),s("h2",{attrs:{id:"一个页面多个js"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一个页面多个js"}},[t._v("#")]),t._v(" 一个页面多个JS")]),t._v(" "),s("p",[t._v("额，这张图不是有重复代码吗？一个"),s("em",[t._v("js")]),t._v("被两个页面都引入了？")]),t._v(" "),s("p",[t._v("这里情况不一样！往下看源码结构。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://qwq9527.gitee.io/resource/imgs//2020-01-10-12-38-03.png",alt:""}})]),t._v(" "),s("p",[t._v("源码结构")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("|—— src\n    |—— pageA   页面A的代码目录\n        |—— index.js 页面A的启动模块\n        |—— ...\n    |—— pageB   页面B的代码目录\n        |—— index.js 页面B的启动模块\n        |—— ...\n    |—— statistics   用于统计访问人数功能目录\n        |—— index.js 启动模块\n        |—— ...\n    |—— common  公共代码目录\n        |—— ...\n")])])]),s("p",[t._v("这里多了一个 "),s("em",[t._v("statistics")]),t._v(" 模块，这个模块的功能和两个页面不相关，是独立的。这种情况下的代码可以单独开一个 "),s("em",[t._v("chunk")]),t._v(" 提取出去。")]),t._v(" "),s("p",[t._v("当然也有可能用到公共模块代码，统计的时候可能需要用到辅助函数，两个页面也可能会用到。")]),t._v(" "),s("p",[t._v("我们说的是，根据入口，如果这个入口分析出来一大堆模块依赖，其中有些是"),s("em",[t._v("common")]),t._v("模块，目前("),s("em",[t._v("章节")]),t._v(")是提取不出去的。")]),t._v(" "),s("p",[t._v("如果两个模块毫不相干，那么这种情况可以提取出去，怎么提取，看下面配置。")]),t._v(" "),s("p",[t._v("webpack配置")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("entry")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("pageA")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./src/pageA/index.js"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("pageB")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./src/pageB/index.js"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("statistics")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./src/statistics/index.js"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("output")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("filename")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"[name].[chunkhash:5].js"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("这种方式适用于页面之间有一些"),s("strong",[t._v("独立")]),t._v("、相同的功能，专门使用一个chunk抽离这部分JS有利于浏览器更好的缓存这部分内容。")]),t._v(" "),s("blockquote",[s("p",[t._v("思考：为什么不使用多启动模块的方式？")]),t._v(" "),s("p",[t._v("这样做是可以的，但是会增加传输量，重复代码每个页面的"),s("em",[t._v("js")]),t._v("都在存在，浏览器无法缓存。")])]),t._v(" "),s("h2",{attrs:{id:"单页应用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#单页应用"}},[t._v("#")]),t._v(" 单页应用")]),t._v(" "),s("p",[t._v("所谓单页应用，是指整个网站（或网站的某一个功能块）只有一个页面，页面中的内容全部靠JS创建和控制。 vue和react都是实现单页应用的利器。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://qwq9527.gitee.io/resource/imgs//2020-01-10-12-44-13.png",alt:""}})]),t._v(" "),s("p",[t._v("源码结构")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("|—— src\n    |—— subFunc   子功能目录\n        |—— ...\n    |—— subFunc   子功能目录\n        |—— ...\n    |—— common  公共代码目录\n        |—— ...\n    |—— index.js\n")])])]),s("p",[t._v("webpack配置")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("entry")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./src/index.js"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("output")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("filename")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"index.[hash:5].js"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=r.exports}}]);