(window.webpackJsonp=window.webpackJsonp||[]).push([[456],{824:function(t,s,e){"use strict";e.r(s);var a=e(10),n=Object(a.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"热替换-hmr-ignore"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#热替换-hmr-ignore"}},[t._v("#")]),t._v(" 热替换 HMR {ignore}")]),t._v(" "),s("blockquote",[s("p",[t._v("热替换并不能降低构建时间（可能还会稍微增加），但可以降低代码改动到效果呈现的时间")])]),t._v(" "),s("p",[t._v("当使用"),s("code",[t._v("webpack-dev-server")]),t._v("时，考虑代码改动到效果呈现的过程")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://qwq9527.gitee.io/resource/imgs/2020-02-21-14-20-49.png",alt:"|400"}})]),t._v(" "),s("p",[t._v("而使用了热替换后，流程发生了变化")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://qwq9527.gitee.io/resource/imgs/2020-02-21-14-22-32.png",alt:"|400"}})]),t._v(" "),s("h1",{attrs:{id:"使用和原理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用和原理"}},[t._v("#")]),t._v(" 使用和原理")]),t._v(" "),s("ol",[s("li",[t._v("更改配置")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("devServer")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("hot")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 开启HMR")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("plugins")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 可选")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("webpack"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("HotModuleReplacementPlugin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("ol",{attrs:{start:"2"}},[s("li",[t._v("更改代码")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// index.js")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 是否开启了热更新")]),t._v("\n  module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("accept")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 接受热更新")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("首先，这段代码会参与最终运行！")]),t._v(" "),s("p",[t._v("当开启了热更新后，"),s("code",[t._v("webpack-dev-server")]),t._v("会向打包结果中注入"),s("code",[t._v("module.hot")]),t._v("属性")]),t._v(" "),s("p",[t._v("默认情况下，"),s("code",[t._v("webpack-dev-server")]),t._v("不管是否开启了热更新，当重新打包后，都会调用"),s("code",[t._v("location.reload")]),t._v("刷新页面")]),t._v(" "),s("p",[t._v("但如果运行了"),s("code",[t._v("module.hot.accept()")]),t._v("，将改变这一行为")]),t._v(" "),s("p",[s("code",[t._v("module.hot.accept()")]),t._v("的作用是让"),s("code",[t._v("webpack-dev-server")]),t._v("通过"),s("code",[t._v("socket")]),t._v("管道，把服务器更新的内容发送到浏览器")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://qwq9527.gitee.io/resource/imgs/2020-02-21-14-34-05.png",alt:"|300"}})]),t._v(" "),s("p",[t._v("然后，将结果交给插件"),s("code",[t._v("HotModuleReplacementPlugin")]),t._v("注入的代码执行")]),t._v(" "),s("p",[t._v("插件"),s("code",[t._v("HotModuleReplacementPlugin")]),t._v("会根据覆盖原始代码，然后让代码重新执行")]),t._v(" "),s("p",[s("strong",[t._v("所以，热替换发生在代码运行期")])]),t._v(" "),s("h1",{attrs:{id:"样式热替换"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#样式热替换"}},[t._v("#")]),t._v(" 样式热替换")]),t._v(" "),s("p",[t._v("对于样式也是可以使用热替换的，但需要使用"),s("code",[t._v("style-loader")])]),t._v(" "),s("p",[t._v("因为热替换发生时，"),s("code",[t._v("HotModuleReplacementPlugin")]),t._v("只会简单的重新运行模块代码")]),t._v(" "),s("p",[t._v("因此"),s("code",[t._v("style-loader")]),t._v("的代码一运行，就会重新设置"),s("code",[t._v("style")]),t._v("元素中的样式")]),t._v(" "),s("p",[t._v("而"),s("code",[t._v("mini-css-extract-plugin")]),t._v("，由于它生成文件是在"),s("strong",[t._v("构建期间")]),t._v("，运行期间并会也无法改动文件，因此它对于热替换是无效的")])])}),[],!1,null,null,null);s.default=n.exports}}]);